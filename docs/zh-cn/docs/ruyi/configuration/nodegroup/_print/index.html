<!doctype html>
<html itemscope itemtype="http://schema.org/WebPage" lang="zh-cn" class="no-js">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="generator" content="Hugo 0.121.2">
<link rel="canonical" type="text/html" href="/zh-cn/docs/ruyi/configuration/nodegroup/">
<link rel="alternate" type="application/rss&#43;xml" href="/zh-cn/docs/ruyi/configuration/nodegroup/index.xml">
<meta name="robots" content="noindex, nofollow">


<link rel="shortcut icon" href="/favicons/favicon.ico" >
<link rel="apple-touch-icon" href="/favicons/apple-touch-icon-180x180.png" sizes="180x180">
<link rel="icon" type="image/png" href="/favicons/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="/favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/favicons/android-36x36.png" sizes="36x36">
<link rel="icon" type="image/png" href="/favicons/android-48x48.png" sizes="48x48">
<link rel="icon" type="image/png" href="/favicons/android-72x72.png" sizes="72x72">
<link rel="icon" type="image/png" href="/favicons/android-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/favicons/android-144x144.png" sizes="144x144">
<link rel="icon" type="image/png" href="/favicons/android-192x192.png" sizes="192x192">

<title>节点组配置参数 | Wiseinf</title>
<meta name="description" content="描述了Ruyi：云原生集群扩缩容引擎的节点组配置参数.
">
<meta property="og:title" content="节点组配置参数" />
<meta property="og:description" content="描述了Ruyi：云原生集群扩缩容引擎的节点组配置参数.
" />
<meta property="og:type" content="website" />
<meta property="og:url" content="/zh-cn/docs/ruyi/configuration/nodegroup/" /><meta property="og:site_name" content="云智优本" />

<meta itemprop="name" content="节点组配置参数">
<meta itemprop="description" content="描述了Ruyi：云原生集群扩缩容引擎的节点组配置参数.
"><meta name="twitter:card" content="summary"/><meta name="twitter:title" content="节点组配置参数"/>
<meta name="twitter:description" content="描述了Ruyi：云原生集群扩缩容引擎的节点组配置参数.
"/>




<link rel="preload" href="/scss/main.min.b9f908f9939278827beae3d5d8ede093dde52fd2c4bcdf7ba620a3d524d46875.css" as="style">
<link href="/scss/main.min.b9f908f9939278827beae3d5d8ede093dde52fd2c4bcdf7ba620a3d524d46875.css" rel="stylesheet" integrity="">

<script
  src="https://code.jquery.com/jquery-3.6.0.min.js"
  integrity="sha384-vtXRMe3mGCbOeY7l30aIg8H9p3GdeSe4IFlP6G8JMa7o7lXvnz3GFKzPxzJdPfGK"
  crossorigin="anonymous"></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-STB7S5D1BR"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-STB7S5D1BR');
}
</script>
  </head>
  <body class="td-section">
    <header>
      <nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar">
<a class="navbar-brand" href="/zh-cn/"><span class="navbar-brand__logo navbar-logo"><svg id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="90" height="60" viewBox="0 0 90 60" enable-background="new 0 0 90 60"><image id="image0" width="90" height="60" x="0" y="0" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFoAAAA8CAMAAADR2113AAAABGdBTUEAALGPC/xhBQAAACBjSFJN AAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAUVBMVEUAAAA/R8s/ScwAoeci u1UisEwisEwzzGYhsUshsUwisUsAf38hsUshsEsisEwAqlUhsEwhsEshsU0isUoisUwA/wA/SMwA ougisUyZ2er///8l8mu7AAAAFnRSTlMAmUyZD4XZBWzxfQKoqKMDgutMd6EBrgesWwAAAAFiS0dE GnVn5DIAAAAJcEhZcwAAEnQAABJ0Ad5mH3gAAAAHdElNRQfmCwIILDYpiAQqAAAAuElEQVRYw+3V yQ7CMAxFUQMZmpZOKQXz/z8KRYLSxrCAFwkJ322ks4jimGhqc5TaTke7kxTNGet4yllDQp/Tvgh8 L5QVkt7zczWO9kuZuWlRdMHrOhBtQkL3HkNbTrMY2gm0w9AsBaGjSMf/pTPedc4XkvFdZ5xGKhN6 QH1PVb2SDyOKJmqWMhGObrt+vudhRNLXdfDYjZ4IS9/mMkZ60bf0m5T+efospbTSSiuttNJKK620 0kpnoC8F20SzlPhKcAAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAyMi0xMS0wMlQwODo0NDo1NCswMDow MEh3G+0AAAAldEVYdGRhdGU6bW9kaWZ5ADIwMjItMTEtMDJUMDg6NDQ6NTQrMDA6MDA5KqNRAAAA KHRFWHRkYXRlOnRpbWVzdGFtcAAyMDIyLTExLTAyVDA4OjQ0OjU0KzAwOjAwbj+CjgAAAABJRU5E rkJggg=="/></svg></span><span class="navbar-brand__name">Wiseinf</span></a>
<div class="td-navbar-nav-scroll ml-md-auto" id="main_navbar">
  <ul class="navbar-nav mt-2 mt-lg-0">
    <li class="nav-item dropdown mr-4 d-none d-lg-block">
      <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown"
      aria-haspopup="true" aria-expanded="false"><span>产品</span></a>
      <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
        <a class="dropdown-item" href="/zh-cn/products/cluster-optimizer"> Cluster Optimizer：云原生集群优化平台 </a>
        <a class="dropdown-item" href="/zh-cn/products/wisecost"> Wisecost：云原生成本管理平台 </a>
        <a class="dropdown-item" href="/zh-cn/products/ruyi"> Ruyi：云原生集群扩缩容引擎</a>
      </div>
      </li>
      
      <li class="nav-item mr-4 mb-2 mb-lg-0">
      <a class="nav-link active" href="/zh-cn/docs/"><span class="active">文档</span></a>
      </li>
      
      <li class="nav-item mr-4 mb-2 mb-lg-0">
      <a class="nav-link" href="/zh-cn/pricing/"><span>价格</span></a>
      </li>
      
      <li class="nav-item mr-4 mb-2 mb-lg-0">
      <a class="nav-link" href="/zh-cn/services/"><span>服务</span></a>
      </li>
      <li class="nav-item dropdown mr-4 d-none d-lg-block">
      

<a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
	中文
</a>
<div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
	
	<a class="dropdown-item" href="/docs/ruyi/configuration/nodegroup/">English</a>
	
</div></li>
    </ul>
</div>
<div class="navbar-nav d-none d-lg-block">
  
</div>
</nav>
    </header>
    <div class="container-fluid td-outer">
      <div class="td-main">
        <div class="row flex-xl-nowrap">
          <main class="col-12 col-md-9 col-xl-8 pl-md-5" role="main">
            




<div class="td-content">
<div class="pageinfo pageinfo-primary d-print-none">
<p>
这是本节的多页打印视图。
<a href="#" onclick="print();return false;">点击此处打印</a>.
</p><p>
<a href="/zh-cn/docs/ruyi/configuration/nodegroup/">返回本页常规视图</a>.
</p>
</div>



<h1 class="title">节点组配置参数</h1>
<div class="lead">描述了Ruyi：云原生集群扩缩容引擎的节点组配置参数.</div>




    <ul>
    
  
  
  
  

  

    </ul>


<div class="content">
      

<div class="pageinfo pageinfo-primary">
<p>Ruyi：云原生集群扩缩容引擎配置。</p>

</div>

<h2 id="节点组配置参数概述">节点组配置参数概述</h2>
<p>引擎必须依赖于节点组配置参数才能运行。节点组配置参数通过命令行参数<code>--config</code>来制定配置文件位置。例如：<code>--config=/etc/ruyi/config.yaml</code></p>
<p>配置文件格式为YAML格式，示例如下：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">nodeGroups</span>:
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">name</span>: <span style="color:#e6db74">&#34;default-pool&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">nodeGroupId</span>: <span style="color:#e6db74">&#34;np1234567890&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">labels</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#f92672">key</span>: <span style="color:#ae81ff">spot_type</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">value</span>: <span style="color:#ae81ff">cpu</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">dryRun</span>: <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">enableAutoscaling</span>: <span style="color:#66d9ef">false</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">autoscaling</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">minNodes</span>: <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">maxNodes</span>: <span style="color:#ae81ff">100</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">enableScaleDown</span>: <span style="color:#66d9ef">false</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">scaleUp</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">threshold</span>: <span style="color:#ae81ff">0.70</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">scaleOnPodPending</span>: <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">silencePeriod</span>: <span style="color:#ae81ff">2m</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">scaleDown</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">threshold</span>: <span style="color:#ae81ff">0.40</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">softDeleteGracePeriod</span>: <span style="color:#ae81ff">1m</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">hardDeleteGracePeriod</span>: <span style="color:#ae81ff">10m</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">maxNodeRemovalRate</span>: <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">taintEffect</span>: <span style="color:#ae81ff">NoExecute</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">enableVirtualCapacity</span>: <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">virtualCapacity</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">prometheusAddress</span>: <span style="color:#e6db74">&#34;http://prometheus:9090&#34;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">prometheusWindow</span>: <span style="color:#e6db74">&#34;2m&#34;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">isThanos</span>: <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">thanosClusterKey</span>: <span style="color:#ae81ff">cluster</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">thanosClusterValue</span>: <span style="color:#ae81ff">default</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">reservationRatio</span>: <span style="color:#ae81ff">0.1</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">increaseSilencePeriod</span>: <span style="color:#ae81ff">2m</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">decreaseSilencePeriod</span>: <span style="color:#ae81ff">2m</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">stabilityWindow</span>: <span style="color:#ae81ff">5m</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">tolerance</span>: <span style="color:#ae81ff">0.1</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">cpuMaxUsage</span>: <span style="color:#ae81ff">0.7</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">maxValue</span>: <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">minValue</span>: <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">resourceReservation</span>: 
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">kubeReserved</span>: <span style="color:#ae81ff">200m</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">SystemReserved</span>: <span style="color:#ae81ff">200m</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">SystemReservedPercentage</span>: <span style="color:#ae81ff">0.1</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">alicloud</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">clusterId</span>: <span style="color:#ae81ff">c1234567890</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">lifecycle</span>: <span style="color:#ae81ff">spot</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">resourceTagging</span>: <span style="color:#66d9ef">false</span>
</span></span></code></pre></div><h2 id="配置参数">配置参数</h2>
<h3 id="name"><code>name</code></h3>
<p>参数<code>name</code>是引擎运行过程中使用的名称，可用于输出友好的日志信息等。不同的节点组名称必须唯一。</p>
<h3 id="labelslabelkey-and-labelvalue"><code>labels</code>，<code>label.Key</code> and <code>label.Value</code></h3>
<p>参数<code>labels</code>是一个键值对数组，引擎通过此键值对数组来选择节点组。
其中，<code>label.Key</code> 和 <code>label.Value</code> 是键-值对中的键和值，</p>
<h3 id="dryrun"><code>dryRun</code></h3>
<p>参数<code>dryRun</code>表示仅运行，不对实际环境做任何修改。该值为<code>false</code>时，可呗命令行参数的<code>dryRun</code>覆盖。</p>
<h3 id="nodegroupid"><code>nodeGroupId</code></h3>
<p>参数<code>nodeGroupId</code>是节点组在云服务商的节点组ID，云服务商通过此参数来从对应云服务商获取改节点组信息。</p>
<h3 id="enableautoscaling"><code>enableAutoscaling</code></h3>
<p>参数<code>enableAutoscaling</code>指示是否启用自动扩缩容特性，默认为<code>true</code>。</p>
<h3 id="autoscaling"><code>autoscaling</code></h3>
<p>参数<code>autoscaling</code>为自动扩缩容提供相应参数，具体请参见<a href="#%E8%87%AA%E5%8A%A8%E6%89%A9%E7%BC%A9%E5%AE%B9%E9%85%8D%E7%BD%AE">自动扩缩容配置</a></p>
<h3 id="enablevirtualcapacity"><code>enableVirtualCapacity</code></h3>
<p>参数<code>enableVirtualCapacity</code>指示是否启用虚拟容量特性，默认为<code>true</code>。</p>
<h3 id="virtualcapacity"><code>virtualCapacity</code></h3>
<p>参数 <code>virtualCapacity</code>为虚拟容量提供相应参数，具体请参见<a href="#%E8%99%9A%E6%8B%9F%E5%AE%B9%E9%87%8F%E9%85%8D%E7%BD%AE">虚拟容量</a></p>
<h3 id="alicloud"><code>alicloud</code></h3>
<p>参数<code>alicloud</code>为云服务商阿里云提供相应参数，具体请参见<a href="#%E9%98%BF%E9%87%8C%E4%BA%91%E6%9C%8D%E5%8A%A1%E5%95%86%E9%85%8D%E7%BD%AE">阿里云服务商配置</a></p>
<h2 id="自动扩缩容配置">自动扩缩容配置</h2>
<p>自动扩缩容配置为节点组自动扩缩容提供相应参数，示例如下：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span>    <span style="color:#f92672">autoscaling</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">minNodes</span>: <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">maxNodes</span>: <span style="color:#ae81ff">100</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">enableScaleUp</span>: <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">enableScaleDown</span>: <span style="color:#66d9ef">false</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">scaleUp</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">threshold</span>: <span style="color:#ae81ff">0.70</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">scaleOnPodPending</span>: <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">silencePeriod</span>: <span style="color:#ae81ff">2m</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">scaleDown</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">threshold</span>: <span style="color:#ae81ff">0.40</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">softDeleteGracePeriod</span>: <span style="color:#ae81ff">1m</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">hardDeleteGracePeriod</span>: <span style="color:#ae81ff">10m</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">maxNodeRemovalRate</span>: <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">taintEffect</span>: <span style="color:#ae81ff">NoExecute</span>
</span></span></code></pre></div><h3 id="minnodes和maxnodes"><code>minNodes</code>和<code>maxNodes</code></h3>
<p>参数<code>minNodes</code>和<code>maxNodes</code>是节点池大小的最大值和最小值。在进行节点扩缩容时，会保证节点池大小满足最大值和最小值的约束。</p>
<h3 id="enablescaleup"><code>enableScaleUp</code></h3>
<p>参数<code>enableScaleUp</code>指示是否启用扩容，默认为<code>true</code>。</p>
<h3 id="enablescaledown"><code>enableScaleDown</code></h3>
<p>参数<code>enableScaleUp</code>指示是否启用缩容，默认为<code>true</code>。</p>
<h3 id="scaleup"><code>scaleUp</code></h3>
<p>参数<code>scaleUp</code>提供扩容相关参数。</p>
<h3 id="scaleupthreshold"><code>scaleUp.threshold</code></h3>
<p>参数<code>scaleUp.threshold</code>是扩容的阈值，当节点组上所有运行Pod的Request总和与节点组Allocatable总和的比值大于此值时，则执行扩容操作。</p>
<h3 id="scaleupscaleonpodpending"><code>scaleUp.scaleOnPodPending</code></h3>
<p>参数<code>scaleUp.scaleOnPodPending</code>指示当Pod Pending时是否执行扩容，默认值为<code>false</code>。当节点组中所有节点都不满足该节点资源需求时，则执行扩容操作。</p>
<h3 id="scaleupsilenceperiod"><code>scaleUp.silencePeriod</code></h3>
<p>参数<code>silencePeriod</code>是沉默时间，当发生扩容事件后，后续在<code>silencePeriod</code>时间内，不再执行扩容操作。</p>
<h3 id="scaledown"><code>scaleDown</code></h3>
<p>参数 <code>scaleDown</code>提供缩容相关参数。</p>
<h3 id="scaledownthreshold"><code>scaleDown.threshold</code></h3>
<p>参数<code>scaleDown.threshold</code>是扩容的阈值，当节点组上所有运行Pod的Request总和与节点组Allocatable总和的比值小于此值时，则执行缩容操作。</p>
<h3 id="scaledownsoftdeletegraceperiod"><code>scaleDown.softDeleteGracePeriod</code></h3>
<p>参数<code>scaleDown.softDeleteGracePeriod</code>是节点软删除等待时间，在软删除等待时间内，引擎不执行缩容操作。</p>
<h3 id="scaledownharddeletegraceperiod"><code>scaleDown.hardDeleteGracePeriod</code></h3>
<p>参数<code>scaleDown.hardDeleteGracePeriod</code>是节点硬删除等待时间，当在软删除等待时间到硬删除等待时间内，只有当节点上的Pod为空时，才会删除节点。在硬删除等待时间之后，引擎会强制删除节点。</p>
<!-- 
节点是否为空的逻辑请参见 `pkg/k8s` `NodeEmpty()` -->
<h3 id="scaledownmaxnoderemovalrate"><code>scaleDown.maxNodeRemovalRate</code></h3>
<p>参数<code>scaleDown.maxNodeRemovalRate</code>是同时缩容节点的最大值。</p>
<h3 id="scaledowntainteffect"><code>scaleDown.taintEffect</code></h3>
<p>参数<code>scaleDown.taintEffect</code>指缩容时的操作，在执行缩容时，将首先给节点打上<code>taint</code>标签，其值取值范围如下：</p>
<ul>
<li>NoSchedule</li>
<li>NoExecute</li>
<li>PreferNoSchedule</li>
</ul>
<p>具体含义，请参见<a href="https://kubernetes.io/docs/concepts/scheduling-eviction/taint-and-toleration">污点和容忍度</a></p>
<h2 id="虚拟容量配置">虚拟容量配置</h2>
<p>虚拟容量配置为虚拟容量提供相应参数。示例如下：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span>    <span style="color:#f92672">virtualCapacity</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">prometheusAddress</span>: <span style="color:#e6db74">&#34;http://prometheus:9090&#34;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">prometheusWindow</span>: <span style="color:#e6db74">&#34;2m&#34;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">isThanos</span>: <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">thanosClusterKey</span>: <span style="color:#ae81ff">cluster</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">thanosClusterValue</span>: <span style="color:#ae81ff">default</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">reservationRatio</span>: <span style="color:#ae81ff">0.1</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">increaseSilencePeriod</span>: <span style="color:#ae81ff">2m</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">decreaseSilencePeriod</span>: <span style="color:#ae81ff">2m</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">stabilityWindow</span>: <span style="color:#ae81ff">5m</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">tolerance</span>: <span style="color:#ae81ff">0.1</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">cpuMaxUsage</span>: <span style="color:#ae81ff">0.7</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">maxValue</span>: <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">minValue</span>: <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">resourceReservation</span>: 
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">kubeReserved</span>: <span style="color:#ae81ff">200m</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">systemReserved</span>: <span style="color:#ae81ff">200m</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">reservedPercentage</span>: <span style="color:#ae81ff">0.1</span> 
</span></span></code></pre></div><h3 id="prometheusaddress"><code>prometheusAddress</code></h3>
<p>参数 <code>prometheusAddress</code>是当前集群节点Metrics监控的Prometheus地址。</p>
<h3 id="prometheuswindow"><code>prometheusWindow</code></h3>
<p>参数 <code>prometheusWindow</code>是引擎查询prometheus时的时间窗口。</p>
<h3 id="isthanos"><code>isThanos</code></h3>
<p>参数<code>isThanos</code>指参数 <code>prometheusAddress</code>对应的Prometheus地址是否为Thanos，默认为false。当prometheus地址是Thanos时，引擎查询时将附加Thanos相关参数。</p>
<h3 id="thanosclusterkey和thanosclustervalue"><code>thanosClusterKey</code>和<code>thanosClusterValue</code></h3>
<p>参数<code>thanosClusterKey</code>和<code>thanosClusterValue</code>是附加到引擎查询时的参数名和参数值（当参数<code>isThanos</code>为<code>true</code>时）。附加参数<code>thanosClusterKey</code>和<code>thanosClusterValue</code>可提升查询性能。</p>
<h3 id="increasesilenceperiod"><code>increaseSilencePeriod</code></h3>
<p>参数<code>increaseSilencePeriod</code>是节点虚拟容量率增加时的静默时间，当节点虚拟容量率增加时，在静默时间窗口<code>increaseSilencePeriod</code>内，将一直保持此值。</p>
<h3 id="decreasesilenceperiod"><code>decreaseSilencePeriod</code></h3>
<p>参数<code>decreaseSilencePeriod</code>是节点虚拟容量率降低时的静默时间，当节点虚拟容量率降低时，在静默时间窗口<code>decreaseSilencePeriod</code>内，将一直保持此值。</p>
<h3 id="stabilitywindow"><code>stabilityWindow</code></h3>
<p>参数<code>stabilityWindow</code>是稳定性窗口，引擎将在每隔一段时间计算一次虚拟容量率，最终决策时将选择稳定性窗口范围内最低值，避免虚拟容量率变化过大，从而引起虚拟容量变化过快。</p>
<h3 id="tolerance"><code>tolerance</code></h3>
<p>参数<code>tolerance</code>是每次应用虚拟容量率时与上次最大差值，此值可防止节点的Allocatable上升过于迅速。</p>
<h3 id="cpumaxusage"><code>cpuMaxUsage</code></h3>
<p>参数<code>cpuMaxUsage</code>是指当CPU利用率最大值，当节点的CPU利用率大于此值时，将不再调度新的Pod。</p>
<h3 id="maxvalue和minvalue"><code>maxValue</code>和<code>minValue</code></h3>
<p>参数<code>maxValue</code>和<code>minValue</code>是虚拟容量率的最大值和最小值。<code>minValue</code>的默认值为1。</p>
<p>虚拟容量率是节点的<code>Allocatable</code>与节点原始的<code>Allocatable</code>的比值。</p>
<h3 id="resourcereservation"><code>resourceReservation</code></h3>
<p>参数<code>resourceReservation</code>是计算虚拟容量率时预留的资源，参数默认值为空。</p>
<p>当参数默认值为空时，引擎将从节点池的节点中获取节点的KubeletConfiguration，并从KubeletConfiguration获取相应值。</p>
<h3 id="resourcereservationkubereserved和resourcereservationsystemreserved"><code>resourceReservation.kubeReserved</code>和<code>resourceReservation.systemReserved</code></h3>
<p>参数<code>resourceReservation.kubeReserved</code>和<code>resourceReservation.systemReserved</code>分别是为kubelet和系统预留的CPU资源。</p>
<h3 id="resourcereservationreservedpercentage"><code>resourceReservation.reservedPercentage</code></h3>
<p>参数<code>resourceReservation.reservedPercentage</code>是引擎为节点上的Pod运行额外预留的资源。</p>
<h2 id="阿里云服务商配置">阿里云服务商配置</h2>
<p>阿里云服务商配置为云服务商阿里云提供相应参数。示例如下：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span>    <span style="color:#f92672">alicloud</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">clusterId</span>: <span style="color:#ae81ff">c1234567890</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">lifecycle</span>: <span style="color:#ae81ff">spot</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">resourceTagging</span>: <span style="color:#66d9ef">false</span>
</span></span></code></pre></div><h3 id="alicloudclusterid"><code>alicloud.clusterId</code></h3>
<p>参数<code>alicloud.clusterId</code>是阿里云ACK集群的集群ID，一般是通过节点上的标签<code>ack.aliyun.com</code>来标识。例如：</p>
<pre tabindex="0"><code>ack.aliyun.com=c1234567890
</code></pre><p>其中，<code>c1234567890</code>即为集群ID。</p>
<h2 id="aws云服务商配置">AWS云服务商配置</h2>
<p>AWS云服务商配置为云服务商AWS提供相应参数，示例如下：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span>    <span style="color:#f92672">aws</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">launchTemplateId</span>: <span style="color:#ae81ff">lt-</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">launchTemplateVersion</span>: <span style="color:#ae81ff">spot</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">instanceReadyTimeout</span>: <span style="color:#ae81ff">2m</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">resourceTagging</span>: <span style="color:#66d9ef">false</span>
</span></span></code></pre></div><h3 id="awslaunchtemplateid和awslaunchtemplateversion"><code>aws.launchTemplateId</code>和<code>aws.launchTemplateVersion</code></h3>
<p>参数<code>aws.launchTemplateId</code>和<code>aws.launchTemplateVersion</code>分别是AWS启动模板ID和模板版本值，用于配置扩容过程中的启动模板。</p>
<p>通过此参数，引擎可以使用AWS Fleet API来一次性将节点池扩容到期望的容量。</p>
<p>参数<code>aws.launchTemplateId</code>和<code>aws.launchTemplateVersion</code>的值可通过两种途径获取：</p>
<ul>
<li>通过AWS EC2控制台中的启动模板页面获取。</li>
<li>通过<a href="https://docs.aws.amazon.com/cli/latest/reference/ec2/create-launch-template.html">创建启动模板</a>中的CLI命令
或者AWS API中返回中的<code>LatestVersionNumber</code>或者<code>DefaultVersionNumber</code>中获取。</li>
</ul>
<h3 id="awsinstancereadytimeout"><code>aws.instanceReadyTimeout</code></h3>
<p>参数<code>aws.instanceReadyTimeout</code>是使用AWS Fleet API来一次性将节点池扩容时等待EC2实例就绪的超时时间。</p>
<p>此参数是可选参数，默认值为1分钟。</p>
<!-- This is an optional field. The default value is 1 minute.

When using the one-shot capacity acquisition for AWS (see `aws.launch_template_id`), this is the maximum amount of time
that Escalator will block waiting for new EC2 instances to become ready so that they can be added to the node group.
This roughly corresponds to the amount of time it takes an instance to boot to multi-user mode and for the EC2 control
plane to notice that it is healthy. This generally takes much less than a minute.

**Note:** Escalator will block other scaling operations for, at most, this amount of time while new capacity comes
online. -->
<h3 id="awslifecyle"><code>aws.lifecyle</code></h3>
<p>参数<code>aws.lifecyle</code>指定实例的生命周期，其取值为<code>on-demand</code>或者<code>spot</code>或者<code>on-demand,spot</code>。</p>
<p>此参数为可选参数，默认值为<code>on-demand</code>。</p>
<p><code>on-demand</code>指示引擎扩容时使用按需实例，<code>spot</code>指示引擎扩容时使用竞价实例。</p>
<h3 id="awsinstancetypeoverrides"><code>aws.instanceTypeOverrides</code></h3>
<p>参数<code>aws.lifecyle</code>指定实例的类型。此参数为可选参数，无默认值。</p>
<p>引擎创建扩容请求时可以使用参数<code>aws.lifecyle</code>指定的多个实例类型，从而增加扩容的成功几率。</p>
<h3 id="awsresourcetagging"><code>aws.resourceTagging</code></h3>
<p>参数<code>aws.resourceTagging</code>指示是否给引擎管理的节点打上资源标签<code>autoscaling.wiseinf.com\enabled</code>:<code>true</code>。</p>
<p>该标签不影响引擎任何功能，主要是便于利用标签对EC2实例进行管理。具体请参考<a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/Using_Tags.html">使用标签</a>。</p>

</div>
</div>


  
  
  
  

  
  

  



          </main>
        </div>
      </div>
      
<footer class="bg-dark py-5 row d-print-none">
  <div class="container-fluid mx-sm-5">
    <div class="row">
      <div class="col-6 col-sm-4 text-xs-center order-sm-2">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="帮助和支持" aria-label="帮助和支持">
    <a class="text-white" target="_blank" rel="noopener" href="mailto:help@wiseinf.com?subject=%e5%b8%ae%e5%8a%a9%e5%92%8c%e6%94%af%e6%8c%81" aria-label="帮助和支持">
      <i class="fa fa-envelope"></i>
    </a>
  </li>
  
</ul>

        
        
      </div>
      <div class="col-6 col-sm-4 text-right text-xs-center order-sm-3">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="商务合作" aria-label="商务合作">
    <a class="text-white" target="_blank" rel="noopener" href="mailto:business@wiseinf.com?subject=%e5%95%86%e5%8a%a1%e5%90%88%e4%bd%9c" aria-label="商务合作">
      <i class="fa fa-envelope"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Github" aria-label="Github">
    <a class="text-white" target="_blank" rel="noopener" href="https://github.com/wiseinf/wiseinf.github.io" aria-label="Github">
      <i class="fab fa-github"></i>
    </a>
  </li>
  
</ul>

        
        
      </div>
      <div class="col-12 col-sm-4 text-center py-2 order-sm-2">
        <small class="text-white">&copy; 2024 北京云智优本科技有限公司 保留所有权利</small>
        
        <p><small class="ms-1"><a href="https://beian.miit.gov.cn/" target="_blank" rel="noopener">京ICP备2023011485号</a></small>
        <small class="ms-1"><a href="https://www.beian.gov.cn/portal/registerSystemInfo?recordcode=11010802042031" target="_blank" rel="noopener">京公安网备11010802042031号</a></small></p>
	
		<p class="mt-2"><a href="/zh-cn/about/">关于我们</a></p>
	
      </div>
    </div>
  </div>
</footer>

    </div>
    
<script src="/local/cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
<script src="/local/stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>











<script src="/js/main.min.604e1b596f799449dffc6f056b597a5d8c1bfedb73f2844175ff85802887b69d.js" integrity="sha256-YE4bWW95lEnf/G8Fa1l6XYwb/ttz8oRBdf&#43;FgCiHtp0=" crossorigin="anonymous"></script>




  </body>
</html>
