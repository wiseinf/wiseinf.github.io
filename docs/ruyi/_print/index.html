<!doctype html>
<html itemscope itemtype="http://schema.org/WebPage" lang="zh-cn" class="no-js">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="generator" content="Hugo 0.109.0">
<link rel="canonical" type="text/html" href="/docs/ruyi/">
<link rel="alternate" type="application/rss&#43;xml" href="/docs/ruyi/index.xml">
<meta name="robots" content="noindex, nofollow">


<link rel="shortcut icon" href="/favicons/favicon.ico" >
<link rel="apple-touch-icon" href="/favicons/apple-touch-icon-180x180.png" sizes="180x180">
<link rel="icon" type="image/png" href="/favicons/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="/favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/favicons/android-36x36.png" sizes="36x36">
<link rel="icon" type="image/png" href="/favicons/android-48x48.png" sizes="48x48">
<link rel="icon" type="image/png" href="/favicons/android-72x72.png" sizes="72x72">
<link rel="icon" type="image/png" href="/favicons/android-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/favicons/android-144x144.png" sizes="144x144">
<link rel="icon" type="image/png" href="/favicons/android-192x192.png" sizes="192x192">

<title>Ruyi：云原生集群扩缩容引擎 | 云智优本</title>
<meta name="description" content="Ruyi：云原生集群扩缩容引擎.
">
<meta property="og:title" content="Ruyi：云原生集群扩缩容引擎" />
<meta property="og:description" content="Ruyi：云原生集群扩缩容引擎.
" />
<meta property="og:type" content="website" />
<meta property="og:url" content="/docs/ruyi/" /><meta property="og:site_name" content="云智优本" />
<meta itemprop="name" content="Ruyi：云原生集群扩缩容引擎">
<meta itemprop="description" content="Ruyi：云原生集群扩缩容引擎.
"><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Ruyi：云原生集群扩缩容引擎"/>
<meta name="twitter:description" content="Ruyi：云原生集群扩缩容引擎.
"/>




<link rel="preload" href="/scss/main.min.4ea71155ebbab2b450693bf10712664219e8a57790acd926d2754dbbccf92827.css" as="style">
<link href="/scss/main.min.4ea71155ebbab2b450693bf10712664219e8a57790acd926d2754dbbccf92827.css" rel="stylesheet" integrity="">

<script
  src="https://code.jquery.com/jquery-3.6.0.min.js"
  integrity="sha384-vtXRMe3mGCbOeY7l30aIg8H9p3GdeSe4IFlP6G8JMa7o7lXvnz3GFKzPxzJdPfGK"
  crossorigin="anonymous"></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-STB7S5D1BR"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-STB7S5D1BR');
}
</script>
  </head>
  <body class="td-section">
    <header>
      <nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar">
<a class="navbar-brand" href="/"><span class="navbar-brand__logo navbar-logo"><svg id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="90" height="60" viewBox="0 0 90 60" enable-background="new 0 0 90 60"><image id="image0" width="90" height="60" x="0" y="0" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFoAAAA8CAMAAADR2113AAAABGdBTUEAALGPC/xhBQAAACBjSFJN AAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAUVBMVEUAAAA/R8s/ScwAoeci u1UisEwisEwzzGYhsUshsUwisUsAf38hsUshsEsisEwAqlUhsEwhsEshsU0isUoisUwA/wA/SMwA ougisUyZ2er///8l8mu7AAAAFnRSTlMAmUyZD4XZBWzxfQKoqKMDgutMd6EBrgesWwAAAAFiS0dE GnVn5DIAAAAJcEhZcwAAEnQAABJ0Ad5mH3gAAAAHdElNRQfmCwIILDYpiAQqAAAAuElEQVRYw+3V yQ7CMAxFUQMZmpZOKQXz/z8KRYLSxrCAFwkJ322ks4jimGhqc5TaTke7kxTNGet4yllDQp/Tvgh8 L5QVkt7zczWO9kuZuWlRdMHrOhBtQkL3HkNbTrMY2gm0w9AsBaGjSMf/pTPedc4XkvFdZ5xGKhN6 QH1PVb2SDyOKJmqWMhGObrt+vudhRNLXdfDYjZ4IS9/mMkZ60bf0m5T+efospbTSSiuttNJKK620 0kpnoC8F20SzlPhKcAAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAyMi0xMS0wMlQwODo0NDo1NCswMDow MEh3G+0AAAAldEVYdGRhdGU6bW9kaWZ5ADIwMjItMTEtMDJUMDg6NDQ6NTQrMDA6MDA5KqNRAAAA KHRFWHRkYXRlOnRpbWVzdGFtcAAyMDIyLTExLTAyVDA4OjQ0OjU0KzAwOjAwbj+CjgAAAABJRU5E rkJggg=="/></svg></span><span class="navbar-brand__name">云智优本</span></a>
<div class="td-navbar-nav-scroll ml-md-auto" id="main_navbar">
  <ul class="navbar-nav mt-2 mt-lg-0">
    <li class="nav-item dropdown mr-4 d-none d-lg-block">
      <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown"
      aria-haspopup="true" aria-expanded="false"><span>产品</span></a>
      <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
        <a class="dropdown-item" href="/products/cluster-optimizer"> Cluster Optimizer：云原生集群优化平台 </a>
        <a class="dropdown-item" href="/products/wisecost"> Wisecost：云原生成本管理平台 </a>
        <a class="dropdown-item" href="/products/ruyi"> Ruyi：云原生集群扩缩容引擎</a>
      </div>
      </li>
      
      <li class="nav-item mr-4 mb-2 mb-lg-0">
      <a class="nav-link active" href="/docs/"><span class="active">文档</span></a>
      </li>
      
      <li class="nav-item mr-4 mb-2 mb-lg-0">
      <a class="nav-link" href="/pricing/"><span>价格</span></a>
      </li>
      
      <li class="nav-item mr-4 mb-2 mb-lg-0">
      <a class="nav-link" href="/services/"><span>服务</span></a>
      </li>
      </ul>
</div>
<div class="navbar-nav d-none d-lg-block">
  
</div>
</nav>
    </header>
    <div class="container-fluid td-outer">
      <div class="td-main">
        <div class="row flex-xl-nowrap">
          <main class="col-12 col-md-9 col-xl-8 pl-md-5" role="main">
            




<div class="td-content">
<div class="pageinfo pageinfo-primary d-print-none">
<p>
这是本节的多页打印视图。
<a href="#" onclick="print();return false;">点击此处打印</a>.
</p><p>
<a href="/docs/ruyi/">返回本页常规视图</a>.
</p>
</div>



<h1 class="title">Ruyi：云原生集群扩缩容引擎</h1>
<div class="lead">Ruyi：云原生集群扩缩容引擎.</div>




    <ul>
    
  
  
  
  

  
    
    
	
<li>1: <a href="#pg-cc7d60fb60c1ccaac59ce2ceb1c8f961">安装部署</a></li>


    
    <ul>
        
  
  
  
  

  

    </ul>
    
  
    
    
	
<li>2: <a href="#pg-802a1bd58ef9bdae22313856241b0f7f">自动扩缩容</a></li>


    
    <ul>
        
  
  
  
  

  

    </ul>
    
  
    
    
	
<li>3: <a href="#pg-9bc01fd7dcd71c629d9b0497e453387a">虚拟容量</a></li>


    
    <ul>
        
  
  
  
  

  

    </ul>
    
  
    
    
	
<li>4: <a href="#pg-1d9cdd8985d61af6eb19f64872c6238c">配置</a></li>


    
    <ul>
        
  
  
  
  

  
    
    
	
<li>4.1: <a href="#pg-311560d092771780a32c6c35dc00ad8c">节点组配置参数</a></li>


    
    <ul>
        
  
  
  
  

  

    </ul>
    
  
    
    
	
<li>4.2: <a href="#pg-743cd90d3c1ba1709b66bd0042c39a58">命令行参数</a></li>


    
    <ul>
        
  
  
  
  

  

    </ul>
    
  

    </ul>
    
  
    
    
	
<li>5: <a href="#pg-db1b774ac87b4e433a86ed299f8a808f">监控</a></li>


    
    <ul>
        
  
  
  
  

  

    </ul>
    
  
    
    
	
<li>6: <a href="#pg-583a7f09d0feaa261a5b4bd84a75d62a">常见问题</a></li>


    
    <ul>
        
  
  
  
  

  

    </ul>
    
  

    </ul>


<div class="content">
      

<div class="pageinfo pageinfo-primary">
<p>Ruyi提供了自动化智能化云原生集群扩缩容引擎.</p>

</div>

<p>Ruyi提供了自动化智能化云原生集群扩缩容引擎，主要功能包括：</p>
<ul>
<li>自动扩缩容：提供基于Pod Request的自动扩缩容。</li>
<li>虚拟容量：通过自动化智能化的技术对节点容量进行弹性伸缩，支持尽可能的调度更多的Pod。</li>
<li>多云支持：支持AWS、阿里云，更多云服务商正在集成中。</li>
<li>监控管理：提供多维度的监控指标数据。</li>
</ul>

</div>
</div>


  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-cc7d60fb60c1ccaac59ce2ceb1c8f961">1 - 安装部署</h1>
    <div class="lead">描述了安装Ruyi：云原生集群扩缩容引擎的详细步骤.</div>
	

<div class="pageinfo pageinfo-primary">
<p>Ruyi：云原生集群扩缩容引擎。</p>

</div>

<p>正在更新中，请稍后。</p>

</div>



    
      
  
  
  
  

  
  

  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-802a1bd58ef9bdae22313856241b0f7f">2 - 自动扩缩容</h1>
    <div class="lead">描述了安装Ruyi：云原生集群扩缩容引擎的详细步骤.</div>
	

<div class="pageinfo pageinfo-primary">
<p>Ruyi：云原生集群扩缩容引擎。</p>

</div>

<h2 id="扩缩容原理">扩缩容原理</h2>
<p>正在更新中，请稍后。</p>

</div>



    
      
  
  
  
  

  
  

  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-9bc01fd7dcd71c629d9b0497e453387a">3 - 虚拟容量</h1>
    <div class="lead">描述了Ruyi：云原生集群扩缩容虚拟容量的原理和应用流程.</div>
	

<div class="pageinfo pageinfo-primary">
<p>Ruyi：云原生集群扩缩容引擎虚拟容量基于对节点请求量、使用量等的分析，动态扩展节点容量，支持用户调度更多的应用，同时尽量保障稳定性。</p>

</div>

<h2 id="虚拟容量概述">虚拟容量概述</h2>
<p>虚拟容量可在特定条件下，将节点容量增长为其原容量3倍（甚至更多），从而支持在节点上调度更多的Pod（应用）。</p>
<p>通过虚拟容量，用户可以显著节省其IT成本。</p>
<h2 id="虚拟容量原理">虚拟容量原理</h2>
<p>要理解虚拟容量，首先要了解Kuberente的调度机制。在Kubernetes中，调度是为应用的Pod指定其运行节点的过程。Pod在被调度时一般都指定其资源需求，其中对于CPU资源，会指定其Request和Limit属性（后面称为<code>CPU Request</code>和<code>CPU Limit</code>）。对于Kubernetes中的节点，一般都有容量属性，容量属性分为两种：1，<code>Capacity</code>：节点的容量上限；2，<code>Allocatable</code>：节点可分配容量上限，会在节点容量上限的基础上去除系统用的资源以及一些预留资源而得到。Kubernetes调度时，在容量方面，会主要考虑Pod的<code>CPU Request</code>和节点的<code>Allocatable</code>是否匹配。匹配的含义是指：当前节点<code>Allocatable</code>的剩余容量，应当大于或等于当前Pod的<code>CPU Request</code>。</p>
<p>当节点<code>Allocatable</code>的剩余容量小于当前Pod的<code>CPU Request</code>时，则不可将此Pod调度到此节点。此时，调度会考虑其他节点，当所有节点都不满足要求时，会直接将Pod挂起，等待有合适的资源再调度。当Pod挂起时，部分Kubernetes提供商提供了集群扩缩容机制，当用户启用此机制时，会在集群中扩展新的节点，将此Pod调度到新的节点中。</p>
<p>事实上，当节点<code>Allocatable</code>的剩余容量小于当前Pod的<code>CPU Request</code>时，可能当前节点上的使用量较低，节点上实际剩余资源要大于当前Pod的<code>CPU Request</code>。从理论上来说，可以将该Pod调度到该节点上。虚拟容量提供了一种机制，可以在特定条件下扩展节点的<code>Allocatable</code>值，让调度认为当前节点<code>Allocatable</code>的剩余容量仍然大于或等于当前Pod的<code>CPU Request</code>，从而将Pod调度到该节点。</p>
<p>通过扩展节点的虚拟容量，可以显著节约IT成本，特别是在开发、测试等资源利用率较低的场合。</p>


<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">注意</h4>

    节点上调度过多Pod可能对节点和应用的稳定性有一定的影响。因此，需根据实际状况设置合适的值，同时利用一些平衡的调度算法。

</div>

<h2 id="案例">案例</h2>
<p>下面我们以一个案例说明如何虚拟容量。</p>
<p>案例中，节点资源为4核8G，我们通过<code>kubectl apply -f nginx.yaml</code>将在其上调度4个Nginx Pod（Pod的<code>CPU Request</code>是2核），如下：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">apiVersion</span>: <span style="color:#ae81ff">apps/v1</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">kind</span>: <span style="color:#ae81ff">Deployment</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">metadata</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">name</span>: <span style="color:#ae81ff">nginx-deployment</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">spec</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">selector</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">matchLabels</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">app</span>: <span style="color:#ae81ff">nginx</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">replicas</span>: <span style="color:#ae81ff">4</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">template</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">metadata</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">labels</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">app</span>: <span style="color:#ae81ff">nginx</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">spec</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">containers</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">nginx</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">image</span>: <span style="color:#ae81ff">nginx:1.14.2</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">ports</span>:
</span></span><span style="display:flex;"><span>        - <span style="color:#f92672">containerPort</span>: <span style="color:#ae81ff">80</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">resources</span>:
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">requests</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">cpu</span>: <span style="color:#ae81ff">2</span> 
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">memory</span>: <span style="color:#ae81ff">500Mi</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">limits</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">cpu</span>: <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">memory</span>: <span style="color:#ae81ff">1024Mi</span>
</span></span></code></pre></div><p>通过<code>kubectl get po</code>查看状态，可以看到有一个Pod处于Pending状态，说明当前节点的<code>Allocatable</code>无法满足<code>nginx-deployment</code>的资源需求。</p>
<pre tabindex="0"><code>********:~/src/nginx$ kubectl get po
NAME                                READY   STATUS    RESTARTS   AGE
nginx-deployment-7dc45fbc49-5k9gd   1/1     Running   0          6s
nginx-deployment-7dc45fbc49-gpq77   1/1     Running   0          2d14h
nginx-deployment-7dc45fbc49-snj6k   0/1     Pending   0          6s
nginx-deployment-7dc45fbc49-v4xsq   1/1     Running   0          41h
</code></pre><p>等待一段时间后，再执行通过<code>kubectl get po</code>查看状态，可以看到所有的Pod都已经运行在节点上。</p>
<pre tabindex="0"><code>********:~/src/nginx$ kubectl get po
NAME                                READY   STATUS    RESTARTS   AGE
nginx-deployment-7dc45fbc49-5k9gd   1/1     Running   0          23m
nginx-deployment-7dc45fbc49-gpq77   1/1     Running   0          2d14h
nginx-deployment-7dc45fbc49-snj6k   1/1     Running   0          23m
nginx-deployment-7dc45fbc49-v4xsq   1/1     Running   0          41h

WUYING\wiseinf_131347202297@6w49f6pbp2eeds8:~/src/nginx$ kubectl describe node 6w49f6pbp2eeds8
Name:               6w49f6pbp2eeds8
Roles:              control-plane,master
Labels:             beta.kubernetes.io/arch=amd64
                    beta.kubernetes.io/os=linux
                    kubernetes.io/arch=amd64
                    kubernetes.io/hostname=6w49f6pbp2eeds8
                    ...
Annotations:        virtualcapacity.wiseinf.com/allocatable: 10200
                    virtualcapacity.wiseinf.com/last-decrease-timestamp: 2023-08-31T10:34:57+08:00
                    virtualcapacity.wiseinf.com/last-increase-timestamp: 2023-08-31T10:37:57+08:00
                    virtualcapacity.wiseinf.com/ratio: 3.000
                    ...
CreationTimestamp:  Fri, 25 Aug 2023 16:23:13 +0800
Taints:             &lt;none&gt;
Unschedulable:      false
Lease:
  HolderIdentity:  6w49f6pbp2eeds8
  AcquireTime:     &lt;unset&gt;
  RenewTime:       Thu, 31 Aug 2023 10:52:51 +0800
Conditions:
  Type                 Status  LastHeartbeatTime                 LastTransitionTime                Reason                       Message
  ----                 ------  -----------------                 ------------------                ------                       -------
  ...
Addresses:
  InternalIP:  198.19.3.220
  Hostname:    6w49f6pbp2eeds8
Capacity:
  cpu:                4
  ephemeral-storage:  82437788Ki
  hugepages-1Gi:      0
  hugepages-2Mi:      0
  memory:             7784472Ki
  pods:               110
Allocatable:
  cpu:                10200m
  ephemeral-storage:  75974665296
  hugepages-1Gi:      0
  hugepages-2Mi:      0
  memory:             7682072Ki
  pods:               110
System Info:
  Machine ID:                 20220524174107033216151293301385
  System UUID:                eddd0796-49a7-4094-afd0-961b8a826663
  Boot ID:                    1b9bde42-fadf-4e83-8af8-3f6cc44a0b99
  Kernel Version:             5.4.0-113-generic
  OS Image:                   Ubuntu 20.04.4 LTS
  Operating System:           linux
  Architecture:               amd64
  Container Runtime Version:  docker://24.0.5
  Kubelet Version:            v1.22.17
  Kube-Proxy Version:         v1.22.17
PodCIDR:                      10.244.0.0/24
PodCIDRs:                     10.244.0.0/24
Non-terminated Pods:          (16 in total)
  Namespace                   Name                                       CPU Requests  CPU Limits  Memory Requests  Memory Limits  Age
  ---------                   ----                                       ------------  ----------  ---------------  -------------  ---
  default                     nginx-deployment-7dc45fbc49-5k9gd          2 (19%)       2 (19%)     500Mi (6%)       1Gi (13%)      39m
  default                     nginx-deployment-7dc45fbc49-gpq77          2 (19%)       2 (19%)     500Mi (6%)       1Gi (13%)      2d15h
  default                     nginx-deployment-7dc45fbc49-snj6k          2 (19%)       2 (19%)     500Mi (6%)       1Gi (13%)      39m
  default                     nginx-deployment-7dc45fbc49-v4xsq          2 (19%)       2 (19%)     500Mi (6%)       1Gi (13%)      41h
  ...
Allocated resources:
  (Total limits may be over 100 percent, i.e., overcommitted.)
  Resource           Requests          Limits
  --------           --------          ------
  cpu                9650m (94%)       11100m (108%)
  memory             3901239040 (49%)  7595365Ki (98%)
  ephemeral-storage  0 (0%)            0 (0%)
  hugepages-1Gi      0 (0%)            0 (0%)
  hugepages-2Mi      0 (0%)            0 (0%)
Events:              &lt;none&gt;
</code></pre><p>从监控指标<code>kube_node_status_allocatable</code>中，可以看到节点<code>6w49f6pbp2eeds8</code>的可分配CPU核数<code>Allocatable</code>一直在增长，直到<strong>10.2</strong>核。同时，从监控指标<code>kube_node_status_capacity</code>中可以到到该节点的容量一直是<strong>4</strong>核。可以看到，节点<code>6w49f6pbp2eeds8</code>的CPU容量扩展了大概2.55倍。</p>







<figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 910px">
	<img class="card-img-top" src="/docs/ruyi/virtualcapacity/node-allocatable_hu31e328ed3036e9882644702f546ce89e_132311_900x0_resize_catmullrom_3.png" width="900" height="433">
	
	<figcaption class="card-body px-0 pt-2 pb-0">
		<p class="card-text">
节点的CPU Allocatable
<small class="text-muted"><br/>Wiseinf Inc.</small></p>
	</figcaption>
	
</figure>








<figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 910px">
	<img class="card-img-top" src="/docs/ruyi/virtualcapacity/node-capacity_hub4e37652f76e254a84e610246b6d8089_55563_900x0_resize_catmullrom_3.png" width="900" height="434">
	
	<figcaption class="card-body px-0 pt-2 pb-0">
		<p class="card-text">
节点的CPU Capacity
<small class="text-muted"><br/>Wiseinf Inc.</small></p>
	</figcaption>
	
</figure>

<p>从监控指标<code>ruyi_node_request_sum</code>中，可以看到节点<code>6w49f6pbp2eeds8</code>上的Pod的CPU请求总和一直在增长，直到<code>nginx-deployment</code>的4个副本调度到节点上并运行。</p>







<figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 910px">
	<img class="card-img-top" src="/docs/ruyi/virtualcapacity/node-cpu-request-sum_huf30fc5671e2b9ef5baf3f476ab942257_107595_900x0_resize_catmullrom_3.png" width="900" height="457">
	
	<figcaption class="card-body px-0 pt-2 pb-0">
		<p class="card-text">
节点的CPU请求总和
<small class="text-muted"><br/>Wiseinf Inc.</small></p>
	</figcaption>
	
</figure>

<p>通过这个案例，可知若能合理利用虚拟容量，将可以节省大量CPU成本。</p>
<p>想了解如何为节点池配置虚拟容量，请参考<a href="/docs/ruyi/configuration/nodegroup/#%E8%99%9A%E6%8B%9F%E5%AE%B9%E9%87%8F%E9%85%8D%E7%BD%AE">虚拟容量配置</a></p>

</div>



    
      
  
  
  
  

  
  

  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-1d9cdd8985d61af6eb19f64872c6238c">4 - 配置</h1>
    <div class="lead">描述Ruyi：云原生集群扩缩容引擎的配置.</div>
	

<div class="pageinfo pageinfo-primary">
<p>Ruyi：云原生集群扩缩容引擎。</p>

</div>

<h2 id="配置ruyi云原生集群扩缩容引擎">配置Ruyi：云原生集群扩缩容引擎</h2>
<p>Ruyi：云原生集群扩缩容引擎提供了自动扩缩容和虚拟容量两大特性。可单独使用某项特性或同时使用两项特性。</p>
<p>可通过命令行参数<code>--features</code>指定。</p>
<p>下面描述单独配置自动扩缩容特性或者虚拟容量特性的主要配置参数。</p>
<h3 id="配置自动扩缩容特性">配置自动扩缩容特性</h3>
<pre tabindex="0"><code>$ ruyi --features=Autoscaling --cloud-provider=alicloud --loglevel=debug --kubeconfig=/opt/ruyi/config/kubeconfig --config=/opt/ruyi/config/config.yaml
</code></pre><h3 id="配置虚拟容量特性">配置虚拟容量特性</h3>
<pre tabindex="0"><code>$ ruyi --features=VirtualCapacity --cloud-provider=alicloud --loglevel=debug --kubeconfig=/opt/ruyi/config/kubeconfig --config=/opt/ruyi/config/config.yaml --webhook-cert-dir=/opt/ruyi/certs/
</code></pre><p>虚拟容量特性涉及到虚拟容量控制器以及Webhook，可通过参数分别控制。</p>
<p>例如，可通过如下命令单独启用虚拟容量控制器：</p>
<pre tabindex="0"><code>$ ruyi --features=VirtualCapacity --cloud-provider=alicloud --loglevel=debug --kubeconfig=/opt/ruyi/config/kubeconfig --config=/opt/ruyi/config/config.yaml --enable-virtual-capacity-controller=true  --enable-webhook=false
      
</code></pre><p>或者，通过如下命令单独启动Webhook：</p>
<pre tabindex="0"><code>$ ruyi --features=VirtualCapacity --cloud-provider=alicloud --loglevel=debug --kubeconfig=/opt/ruyi/config/kubeconfig --config=/opt/ruyi/config/config.yaml
--enable-virtual-capacity-controller=false  --enable-webhook=true --webhook-cert-dir=/opt/ruyi/certs/
</code></pre><p>在配置Webhook时，必须指定<code>MutatingWebhookConfiguration</code>，如下：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">apiVersion</span>: <span style="color:#ae81ff">admissionregistration.k8s.io/v1</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">kind</span>: <span style="color:#ae81ff">MutatingWebhookConfiguration</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">metadata</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">name</span>: <span style="color:#ae81ff">wiseinf-webhooks</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">webhooks</span>:
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">ruyi.wiseinf-system.svc</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">admissionReviewVersions</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">v1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">clientConfig</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">caBundle</span>: <span style="color:#ae81ff">&lt;CA Bundle&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">service</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">name</span>: <span style="color:#ae81ff">ruyi</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">namespace</span>: <span style="color:#ae81ff">wiseinf-system</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">path</span>: <span style="color:#ae81ff">/mutate--v1-node</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">rules</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#f92672">apiGroups</span>:
</span></span><span style="display:flex;"><span>          - <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">apiVersions</span>:
</span></span><span style="display:flex;"><span>          - <span style="color:#ae81ff">v1</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">operations</span>:
</span></span><span style="display:flex;"><span>          - <span style="color:#e6db74">&#34;UPDATE&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">resources</span>:
</span></span><span style="display:flex;"><span>          - <span style="color:#ae81ff">nodes/status</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">scope</span>: <span style="color:#e6db74">&#34;Cluster&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">failurePolicy</span>: <span style="color:#ae81ff">Ignore</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">sideEffects</span>: <span style="color:#ae81ff">None</span>
</span></span></code></pre></div><blockquote>
<p>注意：必须正确指定<code>MutatingWebhookConfiguration</code>的<code>caBundle</code>，否则Webhook不会生效。</p>
</blockquote>
<h3 id="环境变量">环境变量</h3>
<p>使用自动扩缩容特性特性时，需通过环境变量提供云服务商的相关信息。</p>
<p>若使用阿里云，则需通过环境变量配置阿里云的AccessKey及其Region。</p>
<table>
<thead>
<tr>
<th>环境变量名称</th>
<th>说明</th>
<th>默认值</th>
</tr>
</thead>
<tbody>
<tr>
<td>ALIBABA_CLOUD_ACCESS_KEY_ID</td>
<td>阿里云AccessKeyID</td>
<td>无默认值</td>
</tr>
<tr>
<td>ALIBABA_CLOUD_ACCESS_KEY_SECRET</td>
<td>阿里云AccessKeySecret</td>
<td>无默认值</td>
</tr>
<tr>
<td>ALIBABA_CLOUD_REGION_ID</td>
<td>阿里云集群所在地域ID</td>
<td>cn-hangzhou</td>
</tr>
</tbody>
</table>
<p>若使用AWS，则需通过环境变量配置AWS的的AccessKey。</p>
<table>
<thead>
<tr>
<th>环境变量名称</th>
<th>说明</th>
<th>默认值</th>
</tr>
</thead>
<tbody>
<tr>
<td>AWS_ACCESS_KEY_ID 或 AWS_ACCESS_KEY</td>
<td>AWS云AccessKeyID</td>
<td>无默认值</td>
</tr>
<tr>
<td>AWS_SECRET_ACCESS_KEY 或 AWS_SECRET_KEY</td>
<td>AWS云AccessKeySecret</td>
<td>无默认值</td>
</tr>
<tr>
<td>AWS_ASSUME_ROLE_ARN</td>
<td>AWS云ASSUME_ROLE_ARN</td>
<td>无默认值</td>
</tr>
</tbody>
</table>
<p>详细配置项，请参考：</p>
<ul>
<li><a href="/docs/ruyi/configuration/command-line/">命令行配置</a></li>
<li><a href="/docs/ruyi/configuration/nodegroup/">节点组配置</a></li>
</ul>

</div>



    
      
  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-311560d092771780a32c6c35dc00ad8c">4.1 - 节点组配置参数</h1>
    <div class="lead">描述了Ruyi：云原生集群扩缩容引擎的节点组配置参数.</div>
	

<div class="pageinfo pageinfo-primary">
<p>Ruyi：云原生集群扩缩容引擎配置。</p>

</div>

<h2 id="节点组配置参数概述">节点组配置参数概述</h2>
<p>引擎必须依赖于节点组配置参数才能运行。节点组配置参数通过命令行参数<code>--config</code>来制定配置文件位置。例如：<code>--config=/etc/ruyi/config.yaml</code></p>
<p>配置文件格式为YAML格式，示例如下：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">nodeGroups</span>:
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">name</span>: <span style="color:#e6db74">&#34;default-pool&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">nodeGroupId</span>: <span style="color:#e6db74">&#34;np1234567890&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">labels</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#f92672">key</span>: <span style="color:#ae81ff">spot_type</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">value</span>: <span style="color:#ae81ff">cpu</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">dryRun</span>: <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">enableAutoscaling</span>: <span style="color:#66d9ef">false</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">autoscaling</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">minNodes</span>: <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">maxNodes</span>: <span style="color:#ae81ff">100</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">enableScaleDown</span>: <span style="color:#66d9ef">false</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">scaleUp</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">threshold</span>: <span style="color:#ae81ff">0.70</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">scaleOnPodPending</span>: <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">silencePeriod</span>: <span style="color:#ae81ff">2m</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">scaleDown</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">threshold</span>: <span style="color:#ae81ff">0.40</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">softDeleteGracePeriod</span>: <span style="color:#ae81ff">1m</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">hardDeleteGracePeriod</span>: <span style="color:#ae81ff">10m</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">maxNodeRemovalRate</span>: <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">taintEffect</span>: <span style="color:#ae81ff">NoExecute</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">enableVirtualCapacity</span>: <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">virtualCapacity</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">prometheusAddress</span>: <span style="color:#e6db74">&#34;http://prometheus:9090&#34;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">prometheusWindow</span>: <span style="color:#e6db74">&#34;2m&#34;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">isThanos</span>: <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">thanosClusterKey</span>: <span style="color:#ae81ff">cluster</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">thanosClusterValue</span>: <span style="color:#ae81ff">default</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">reservationRatio</span>: <span style="color:#ae81ff">0.1</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">increaseSilencePeriod</span>: <span style="color:#ae81ff">2m</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">decreaseSilencePeriod</span>: <span style="color:#ae81ff">2m</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">stabilityWindow</span>: <span style="color:#ae81ff">5m</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">tolerance</span>: <span style="color:#ae81ff">0.1</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">cpuMaxUsage</span>: <span style="color:#ae81ff">0.7</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">maxValue</span>: <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">minValue</span>: <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">resourceReservation</span>: 
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">kubeReserved</span>: <span style="color:#ae81ff">200m</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">SystemReserved</span>: <span style="color:#ae81ff">200m</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">SystemReservedPercentage</span>: <span style="color:#ae81ff">0.1</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">alicloud</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">clusterId</span>: <span style="color:#ae81ff">c1234567890</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">lifecycle</span>: <span style="color:#ae81ff">spot</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">resourceTagging</span>: <span style="color:#66d9ef">false</span>
</span></span></code></pre></div><h2 id="配置参数">配置参数</h2>
<h3 id="name"><code>name</code></h3>
<p>参数<code>name</code>是引擎运行过程中使用的名称，可用于输出友好的日志信息等。不同的节点组名称必须唯一。</p>
<h3 id="labelslabelkey-and-labelvalue"><code>labels</code>，<code>label.Key</code> and <code>label.Value</code></h3>
<p>参数<code>labels</code>是一个键值对数组，引擎通过此键值对数组来选择节点组。
其中，<code>label.Key</code> 和 <code>label.Value</code> 是键-值对中的键和值，</p>
<h3 id="dryrun"><code>dryRun</code></h3>
<p>参数<code>dryRun</code>表示仅运行，不对实际环境做任何修改。该值为<code>false</code>时，可呗命令行参数的<code>dryRun</code>覆盖。</p>
<h3 id="nodegroupid"><code>nodeGroupId</code></h3>
<p>参数<code>nodeGroupId</code>是节点组在云服务商的节点组ID，云服务商通过此参数来从对应云服务商获取改节点组信息。</p>
<h3 id="enableautoscaling"><code>enableAutoscaling</code></h3>
<p>参数<code>enableAutoscaling</code>指示是否启用自动扩缩容特性，默认为<code>true</code>。</p>
<h3 id="autoscaling"><code>autoscaling</code></h3>
<p>参数<code>autoscaling</code>为自动扩缩容提供相应参数，具体请参见<a href="#%E8%87%AA%E5%8A%A8%E6%89%A9%E7%BC%A9%E5%AE%B9%E9%85%8D%E7%BD%AE">自动扩缩容配置</a></p>
<h3 id="enablevirtualcapacity"><code>enableVirtualCapacity</code></h3>
<p>参数<code>enableVirtualCapacity</code>指示是否启用虚拟容量特性，默认为<code>true</code>。</p>
<h3 id="virtualcapacity"><code>virtualCapacity</code></h3>
<p>参数 <code>virtualCapacity</code>为虚拟容量提供相应参数，具体请参见<a href="#%E8%99%9A%E6%8B%9F%E5%AE%B9%E9%87%8F%E9%85%8D%E7%BD%AE">虚拟容量</a></p>
<h3 id="alicloud"><code>alicloud</code></h3>
<p>参数<code>alicloud</code>为云服务商阿里云提供相应参数，具体请参见<a href="#%E9%98%BF%E9%87%8C%E4%BA%91%E6%9C%8D%E5%8A%A1%E5%95%86%E9%85%8D%E7%BD%AE">阿里云服务商配置</a></p>
<h2 id="自动扩缩容配置">自动扩缩容配置</h2>
<p>自动扩缩容配置为节点组自动扩缩容提供相应参数，示例如下：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span>    <span style="color:#f92672">autoscaling</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">minNodes</span>: <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">maxNodes</span>: <span style="color:#ae81ff">100</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">enableScaleUp</span>: <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">enableScaleDown</span>: <span style="color:#66d9ef">false</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">scaleUp</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">threshold</span>: <span style="color:#ae81ff">0.70</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">scaleOnPodPending</span>: <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">silencePeriod</span>: <span style="color:#ae81ff">2m</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">scaleDown</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">threshold</span>: <span style="color:#ae81ff">0.40</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">softDeleteGracePeriod</span>: <span style="color:#ae81ff">1m</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">hardDeleteGracePeriod</span>: <span style="color:#ae81ff">10m</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">maxNodeRemovalRate</span>: <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">taintEffect</span>: <span style="color:#ae81ff">NoExecute</span>
</span></span></code></pre></div><h3 id="minnodes和maxnodes"><code>minNodes</code>和<code>maxNodes</code></h3>
<p>参数<code>minNodes</code>和<code>maxNodes</code>是节点池大小的最大值和最小值。在进行节点扩缩容时，会保证节点池大小满足最大值和最小值的约束。</p>
<h3 id="enablescaleup"><code>enableScaleUp</code></h3>
<p>参数<code>enableScaleUp</code>指示是否启用扩容，默认为<code>true</code>。</p>
<h3 id="enablescaledown"><code>enableScaleDown</code></h3>
<p>参数<code>enableScaleUp</code>指示是否启用缩容，默认为<code>true</code>。</p>
<h3 id="scaleup"><code>scaleUp</code></h3>
<p>参数<code>scaleUp</code>提供扩容相关参数。</p>
<h3 id="scaleupthreshold"><code>scaleUp.threshold</code></h3>
<p>参数<code>scaleUp.threshold</code>是扩容的阈值，当节点组上所有运行Pod的Request总和与节点组Allocatable总和的比值大于此值时，则执行扩容操作。</p>
<h3 id="scaleupscaleonpodpending"><code>scaleUp.scaleOnPodPending</code></h3>
<p>参数<code>scaleUp.scaleOnPodPending</code>指示当Pod Pending时是否执行扩容，默认值为<code>false</code>。当节点组中所有节点都不满足该节点资源需求时，则执行扩容操作。</p>
<h3 id="scaleupsilenceperiod"><code>scaleUp.silencePeriod</code></h3>
<p>参数<code>silencePeriod</code>是沉默时间，当发生扩容事件后，后续在<code>silencePeriod</code>时间内，不再执行扩容操作。</p>
<h3 id="scaledown"><code>scaleDown</code></h3>
<p>参数 <code>scaleDown</code>提供缩容相关参数。</p>
<h3 id="scaledownthreshold"><code>scaleDown.threshold</code></h3>
<p>参数<code>scaleDown.threshold</code>是扩容的阈值，当节点组上所有运行Pod的Request总和与节点组Allocatable总和的比值小于此值时，则执行缩容操作。</p>
<h3 id="scaledownsoftdeletegraceperiod"><code>scaleDown.softDeleteGracePeriod</code></h3>
<p>参数<code>scaleDown.softDeleteGracePeriod</code>是节点软删除等待时间，在软删除等待时间内，引擎不执行缩容操作。</p>
<h3 id="scaledownharddeletegraceperiod"><code>scaleDown.hardDeleteGracePeriod</code></h3>
<p>参数<code>scaleDown.hardDeleteGracePeriod</code>是节点硬删除等待时间，当在软删除等待时间到硬删除等待时间内，只有当节点上的Pod为空时，才会删除节点。在硬删除等待时间之后，引擎会强制删除节点。</p>
<!-- 
节点是否为空的逻辑请参见 `pkg/k8s` `NodeEmpty()` -->
<h3 id="scaledownmaxnoderemovalrate"><code>scaleDown.maxNodeRemovalRate</code></h3>
<p>参数<code>scaleDown.maxNodeRemovalRate</code>是同时缩容节点的最大值。</p>
<h3 id="scaledowntainteffect"><code>scaleDown.taintEffect</code></h3>
<p>参数<code>scaleDown.taintEffect</code>指缩容时的操作，在执行缩容时，将首先给节点打上<code>taint</code>标签，其值取值范围如下：</p>
<ul>
<li>NoSchedule</li>
<li>NoExecute</li>
<li>PreferNoSchedule</li>
</ul>
<p>具体含义，请参见<a href="https://kubernetes.io/docs/concepts/scheduling-eviction/taint-and-toleration">污点和容忍度</a></p>
<h2 id="虚拟容量配置">虚拟容量配置</h2>
<p>虚拟容量配置为虚拟容量提供相应参数。示例如下：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span>    <span style="color:#f92672">virtualCapacity</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">prometheusAddress</span>: <span style="color:#e6db74">&#34;http://prometheus:9090&#34;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">prometheusWindow</span>: <span style="color:#e6db74">&#34;2m&#34;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">isThanos</span>: <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">thanosClusterKey</span>: <span style="color:#ae81ff">cluster</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">thanosClusterValue</span>: <span style="color:#ae81ff">default</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">reservationRatio</span>: <span style="color:#ae81ff">0.1</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">increaseSilencePeriod</span>: <span style="color:#ae81ff">2m</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">decreaseSilencePeriod</span>: <span style="color:#ae81ff">2m</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">stabilityWindow</span>: <span style="color:#ae81ff">5m</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">tolerance</span>: <span style="color:#ae81ff">0.1</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">cpuMaxUsage</span>: <span style="color:#ae81ff">0.7</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">maxValue</span>: <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">minValue</span>: <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">resourceReservation</span>: 
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">kubeReserved</span>: <span style="color:#ae81ff">200m</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">systemReserved</span>: <span style="color:#ae81ff">200m</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">reservedPercentage</span>: <span style="color:#ae81ff">0.1</span> 
</span></span></code></pre></div><h3 id="prometheusaddress"><code>prometheusAddress</code></h3>
<p>参数 <code>prometheusAddress</code>是当前集群节点Metrics监控的Prometheus地址。</p>
<h3 id="prometheuswindow"><code>prometheusWindow</code></h3>
<p>参数 <code>prometheusWindow</code>是引擎查询prometheus时的时间窗口。</p>
<h3 id="isthanos"><code>isThanos</code></h3>
<p>参数<code>isThanos</code>指参数 <code>prometheusAddress</code>对应的Prometheus地址是否为Thanos，默认为false。当prometheus地址是Thanos时，引擎查询时将附加Thanos相关参数。</p>
<h3 id="thanosclusterkey和thanosclustervalue"><code>thanosClusterKey</code>和<code>thanosClusterValue</code></h3>
<p>参数<code>thanosClusterKey</code>和<code>thanosClusterValue</code>是附加到引擎查询时的参数名和参数值（当参数<code>isThanos</code>为<code>true</code>时）。附加参数<code>thanosClusterKey</code>和<code>thanosClusterValue</code>可提升查询性能。</p>
<h3 id="increasesilenceperiod"><code>increaseSilencePeriod</code></h3>
<p>参数<code>increaseSilencePeriod</code>是节点虚拟容量率增加时的静默时间，当节点虚拟容量率增加时，在静默时间窗口<code>increaseSilencePeriod</code>内，将一直保持此值。</p>
<h3 id="decreasesilenceperiod"><code>decreaseSilencePeriod</code></h3>
<p>参数<code>decreaseSilencePeriod</code>是节点虚拟容量率降低时的静默时间，当节点虚拟容量率降低时，在静默时间窗口<code>decreaseSilencePeriod</code>内，将一直保持此值。</p>
<h3 id="stabilitywindow"><code>stabilityWindow</code></h3>
<p>参数<code>stabilityWindow</code>是稳定性窗口，引擎将在每隔一段时间计算一次虚拟容量率，最终决策时将选择稳定性窗口范围内最低值，避免虚拟容量率变化过大，从而引起虚拟容量变化过快。</p>
<h3 id="tolerance"><code>tolerance</code></h3>
<p>参数<code>tolerance</code>是每次应用虚拟容量率时与上次最大差值，此值可防止节点的Allocatable上升过于迅速。</p>
<h3 id="cpumaxusage"><code>cpuMaxUsage</code></h3>
<p>参数<code>cpuMaxUsage</code>是指当CPU利用率最大值，当节点的CPU利用率大于此值时，将不再调度新的Pod。</p>
<h3 id="maxvalue和minvalue"><code>maxValue</code>和<code>minValue</code></h3>
<p>参数<code>maxValue</code>和<code>minValue</code>是虚拟容量率的最大值和最小值。<code>minValue</code>的默认值为1。</p>
<p>虚拟容量率是节点的<code>Allocatable</code>与节点原始的<code>Allocatable</code>的比值。</p>
<h3 id="resourcereservation"><code>resourceReservation</code></h3>
<p>参数<code>resourceReservation</code>是计算虚拟容量率时预留的资源，参数默认值为空。</p>
<p>当参数默认值为空时，引擎将从节点池的节点中获取节点的KubeletConfiguration，并从KubeletConfiguration获取相应值。</p>
<h3 id="resourcereservationkubereserved和resourcereservationsystemreserved"><code>resourceReservation.kubeReserved</code>和<code>resourceReservation.systemReserved</code></h3>
<p>参数<code>resourceReservation.kubeReserved</code>和<code>resourceReservation.systemReserved</code>分别是为kubelet和系统预留的CPU资源。</p>
<h3 id="resourcereservationreservedpercentage"><code>resourceReservation.reservedPercentage</code></h3>
<p>参数<code>resourceReservation.reservedPercentage</code>是引擎为节点上的Pod运行额外预留的资源。</p>
<h2 id="阿里云服务商配置">阿里云服务商配置</h2>
<p>阿里云服务商配置为云服务商阿里云提供相应参数。示例如下：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span>    <span style="color:#f92672">alicloud</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">clusterId</span>: <span style="color:#ae81ff">c1234567890</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">lifecycle</span>: <span style="color:#ae81ff">spot</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">resourceTagging</span>: <span style="color:#66d9ef">false</span>
</span></span></code></pre></div><h3 id="alicloudclusterid"><code>alicloud.clusterId</code></h3>
<p>参数<code>alicloud.clusterId</code>是阿里云ACK集群的集群ID，一般是通过节点上的标签<code>ack.aliyun.com</code>来标识。例如：</p>
<pre tabindex="0"><code>ack.aliyun.com=c1234567890
</code></pre><p>其中，<code>c1234567890</code>即为集群ID。</p>
<h2 id="aws云服务商配置">AWS云服务商配置</h2>
<p>AWS云服务商配置为云服务商AWS提供相应参数，示例如下：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span>    <span style="color:#f92672">aws</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">launchTemplateId</span>: <span style="color:#ae81ff">lt-</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">launchTemplateVersion</span>: <span style="color:#ae81ff">spot</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">instanceReadyTimeout</span>: <span style="color:#ae81ff">2m</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">resourceTagging</span>: <span style="color:#66d9ef">false</span>
</span></span></code></pre></div><h3 id="awslaunchtemplateid和awslaunchtemplateversion"><code>aws.launchTemplateId</code>和<code>aws.launchTemplateVersion</code></h3>
<p>参数<code>aws.launchTemplateId</code>和<code>aws.launchTemplateVersion</code>分别是AWS启动模板ID和模板版本值，用于配置扩容过程中的启动模板。</p>
<p>通过此参数，引擎可以使用AWS Fleet API来一次性将节点池扩容到期望的容量。</p>
<p>参数<code>aws.launchTemplateId</code>和<code>aws.launchTemplateVersion</code>的值可通过两种途径获取：</p>
<ul>
<li>通过AWS EC2控制台中的启动模板页面获取。</li>
<li>通过<a href="https://docs.aws.amazon.com/cli/latest/reference/ec2/create-launch-template.html">创建启动模板</a>中的CLI命令
或者AWS API中返回中的<code>LatestVersionNumber</code>或者<code>DefaultVersionNumber</code>中获取。</li>
</ul>
<h3 id="awsinstancereadytimeout"><code>aws.instanceReadyTimeout</code></h3>
<p>参数<code>aws.instanceReadyTimeout</code>是使用AWS Fleet API来一次性将节点池扩容时等待EC2实例就绪的超时时间。</p>
<p>此参数是可选参数，默认值为1分钟。</p>
<!-- This is an optional field. The default value is 1 minute.

When using the one-shot capacity acquisition for AWS (see `aws.launch_template_id`), this is the maximum amount of time
that Escalator will block waiting for new EC2 instances to become ready so that they can be added to the node group.
This roughly corresponds to the amount of time it takes an instance to boot to multi-user mode and for the EC2 control
plane to notice that it is healthy. This generally takes much less than a minute.

**Note:** Escalator will block other scaling operations for, at most, this amount of time while new capacity comes
online. -->
<h3 id="awslifecyle"><code>aws.lifecyle</code></h3>
<p>参数<code>aws.lifecyle</code>指定实例的生命周期，其取值为<code>on-demand</code>或者<code>spot</code>或者<code>on-demand,spot</code>。</p>
<p>此参数为可选参数，默认值为<code>on-demand</code>。</p>
<p><code>on-demand</code>指示引擎扩容时使用按需实例，<code>spot</code>指示引擎扩容时使用竞价实例。</p>
<h3 id="awsinstancetypeoverrides"><code>aws.instanceTypeOverrides</code></h3>
<p>参数<code>aws.lifecyle</code>指定实例的类型。此参数为可选参数，无默认值。</p>
<p>引擎创建扩容请求时可以使用参数<code>aws.lifecyle</code>指定的多个实例类型，从而增加扩容的成功几率。</p>
<h3 id="awsresourcetagging"><code>aws.resourceTagging</code></h3>
<p>参数<code>aws.resourceTagging</code>指示是否给引擎管理的节点打上资源标签<code>autoscaling.wiseinf.com\enabled</code>:<code>true</code>。</p>
<p>该标签不影响引擎任何功能，主要是便于利用标签对EC2实例进行管理。具体请参考<a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/Using_Tags.html">使用标签</a>。</p>

</div>



    
      
  
  
  
  

  
  

  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-743cd90d3c1ba1709b66bd0042c39a58">4.2 - 命令行参数</h1>
    <div class="lead">描述了Ruyi：云原生集群扩缩容引擎的命令行参数。</div>
	

<div class="pageinfo pageinfo-primary">
<p>Ruyi：云原生集群扩缩容引擎。</p>

</div>

<h2 id="命令行参数">命令行参数</h2>
<p>通过 <code>--help</code> 可以获取Ruyi引擎的用法，如下：</p>
<pre tabindex="0"><code>$ruyi --help
usage: ruyi --config=CONFIG [&lt;flags&gt;]

Flags:
      --help                     Show context-sensitive help (also try --help-long and --help-man).
  -f, --features=&#34;Autoscaling,VirtualCapacity&#34;  
                                 Enable ruyi features. Available options are Autoscaling, VirtualCapacity
      --cloud-provider=aws       Set cloud provider to use. Available options are (aws, alicloud)
      --config=CONFIG            Set config file location
      --kubeconfig=KUBECONFIG    Set kubeconfig file location
      --interval=60s             Set interval for evaluating node scale up or down
      --metrics-address=&#34;:8080&#34;  Set address for /metrics
      --health-probe-address=&#34;:8090&#34;  
                                 Set address for health probe
      --port=8443                Set port
      --dry-run                  Set dry-run argument. If true, forces dry run on all nodegroups
  -v, --loglevel=info            Set logging level. Available options are (trace, debug, info, warning, error, fatal, panic)
      --logfmt=text              Set logging format. Available options are (text, json)
      --enable-virtual-capacity-controller  
                                 Set enable virtual capacity controller
      --enable-webhook           Set enable webhook for virtual capacity
      --webhook-cert-dir=&#34;&#34;      Set webhook certificate directory
      --concurrency=5            Set concurrency
      --leader-elect             Enable leader election
      --leader-elect-lease-duration=15s  
                                 Set leader election lease duration
      --leader-elect-renew-deadline=10s  
                                 Set leader election renew deadline
      --leader-elect-retry-period=2s  
                                 Set leader election retry period
      --leader-elect-lease-namespace=&#34;wiseinf-system&#34;  
                                 Set leader election lease object namespace
      --leader-elect-lease-name=&#34;ruyi-lease&#34;  
                                 Set leader election lease object name
</code></pre><p>下面将对参数进行详细描述。</p>
<h2 id="参数描述">参数描述</h2>
<h3 id="--help"><code>--help</code></h3>
<p>参数<code>--help</code>提供命令行的用法帮助。</p>
<h3 id="-f---features"><code>-f, --features</code></h3>
<p>参数 <code>-f, --features</code>指示引擎启动的特性，其中<code>Autoscaling</code>表示启用自动扩缩容特性，<code>VirtualCapacity</code>表示启动虚拟容量特性。</p>
<p>默认值为<code>Autoscaling,VirtualCapacity</code>，表示同时启用自动扩缩容特性和虚拟容量特性。</p>
<h3 id="--cloud-provider"><code>--cloud-provider</code></h3>
<p>参数<code>--cloud-provider</code>指示引擎所使用的云服务提供商。其取值为aws或者alicloud，默认值为aws。</p>
<h3 id="--config"><code>--config</code></h3>
<p>参数<code>--config</code>指示引擎所使用的节点组配置文件位置。节点组配置请参见<a href="/docs/ruyi/configuration/nodegroup">节点组配置</a></p>
<h3 id="--kubeconfig"><code>--kubeconfig</code></h3>
<p>参数<code>--kubeconfig</code>指示引擎所使用的kubeconfig文件位置。默认为空，此时将使用集群内访问配置。</p>
<h3 id="--interval"><code>--interval</code></h3>
<p>参数<code>--interval</code>指示引擎中功能特性所使用的调度间隔。比如，自动扩缩容每间隔此时间就评估节点池是扩容还是缩容。</p>
<p>此默认值为60秒。</p>
<h3 id="--metrics-address"><code>--metrics-address</code></h3>
<p>参数<code>--metrics-address</code>指示引擎所使用的监控指标的端口，可从此端口的<code>/metrics</code>获取具体的指标数据。</p>
<h3 id="--health-probe-address"><code>--health-probe-address</code></h3>
<p>参数<code>--health-probe-address</code>指示引擎所使用的监控探测地址，可从此端口的<code>/healthz</code>和<code>/readyz</code>分别进行健康探测和就绪探测。</p>
<h3 id="--port"><code>--port</code></h3>
<p>参数<code>--port</code>是引擎Webhook所使用的端口，默认值是8443.</p>
<h3 id="--dry-run"><code>--dry-run</code></h3>
<p>参数<code>--dry-run</code>指示引擎仅运行，不对环境、节点做任何修改。</p>
<h3 id="-v---loglevelinfo"><code>-v, --loglevel=info</code></h3>
<p>参数<code>--dry-run</code>设置日志级别。可选值包括<code>trace</code>, <code>debug</code>, <code>info</code>, <code>warning</code>, <code>error</code>, <code>fatal</code>, <code>panic</code>，默认值为<code>info</code>。</p>
<h3 id="--logfmt"><code>--logfmt</code></h3>
<p>参数<code>--dry-run</code>设置日志输出格式。可选值包括<code>text</code>, <code>json</code>，默认值为<code>text</code>，表示输出位文本格式。</p>
<h3 id="--enable-virtual-capacity-controller"><code>--enable-virtual-capacity-controller</code></h3>
<p>参数<code>--enable-virtual-capacity-controller</code>表示是否启用虚拟容量控制器，默认值为<code>true</code>。</p>
<h3 id="--enable-webhook"><code>--enable-webhook</code></h3>
<p>参数<code>--enable-webhook</code>表示是否启用Webhook，默认值为<code>true</code>。</p>
<h3 id="--webhook-cert-dir"><code>--webhook-cert-dir</code></h3>
<p>参数<code>--webhook-cert-dir</code>标明启用Webhook时证书的目录位置。引擎将通过此目录位置下的文件<code>tls.crt</code>和<code>tls.key</code>来初始化Webhook的证书。
若其值为空，则Webhook将在目录<code>/tmp/k8s-webhook-server/serving-certs</code>中查找证书</p>
<!-- ### `--concurrency`

参数`--concurrency`指示并发数。默认值为5，暂未使用。 -->
<h3 id="--leader-elect"><code>--leader-elect</code></h3>
<p>参数<code>--leader-elect</code>设置是否启用选主机制。一般在高可用环境下使用。</p>
<h3 id="leader-elect-lease-duration"><code>leader-elect-lease-duration</code></h3>
<p>参数 <code>leader-elect-lease-duration</code>设置非主节点获取选主租约的等待时间。默认值为15秒。</p>
<h3 id="--leader-elect-renew-deadline"><code>--leader-elect-renew-deadline</code></h3>
<p>参数<code>--leader-elect-renew-deadline</code>设置主节点更新租约的超时时间。默认值为10秒。</p>
<h3 id="--leader-elect-retry-period"><code>--leader-elect-retry-period</code></h3>
<p>参数<code>--leader-elect-renew-deadline</code>设置节点重试时的等待时间。默认值为2秒。</p>
<h3 id="--leader-elect-lease-namespace"><code>--leader-elect-lease-namespace</code></h3>
<p>参数<code>--leader-elect-lease-namespace</code>设置存储租约的名称空间。默认值为<code>wiseinf-system</code>.</p>
<h3 id="--leader-elect-lease-name"><code>--leader-elect-lease-name</code></h3>
<p>参数<code>--leader-elect-lease-name</code>设置租约的名称。默认值为<code>ruyi-lease</code>.</p>

</div>



    
      
  
  
  
  

  
  

  

    
	
  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-db1b774ac87b4e433a86ed299f8a808f">5 - 监控</h1>
    <div class="lead">描述了Ruyi：云原生扩缩容引擎相关的监控机制</div>
	

<div class="pageinfo pageinfo-primary">
<p>Ruyi：云原生集群扩缩容引擎监控。</p>

</div>

<h2 id="监控">监控</h2>
<p>云原生扩缩容引擎提供了一些列的监控指标，支持通过Prometheus/Thanos对其进行监控。</p>
<h3 id="自动扩缩容指标">自动扩缩容指标</h3>
<table>
<thead>
<tr>
<th>指标名称</th>
<th>标签</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>ruyi_autoscaling_run_count</td>
<td>无</td>
<td>自动扩缩容运行次数</td>
</tr>
<tr>
<td>ruyi_nodegroup_nodes</td>
<td>nodegroup: 节点组名称<br/>type: 节点类型</td>
<td>节点组各类型节点数量</td>
</tr>
<tr>
<td>ruyi_nodegroup_pods</td>
<td>nodegroup: 节点组名称</td>
<td>节点组各类型Pod数量</td>
</tr>
<tr>
<td>ruyi_nodegroup_request</td>
<td>nodegroup: 节点组名称<br/> resource: 资源类型</td>
<td>节点组请求量</td>
</tr>
<tr>
<td>ruyi_nodegroup_capacity</td>
<td>nodegroup: 节点组名称<br/> resource: 资源类型</td>
<td>节点组容量</td>
</tr>
<tr>
<td>ruyi_nodegroup_percent</td>
<td>nodegroup: 节点组名称<br/> resource: 资源类型</td>
<td>节点组请求量百分比</td>
</tr>
<tr>
<td>ruyi_nodegroup_scale_delta</td>
<td>nodegroup: 节点组名称</td>
<td>节点组节点调整量</td>
</tr>
<tr>
<td>ruyi_nodegroup_size</td>
<td>nodegroup: 节点组名称<br/> id: 节点组ID <br/> cloud_provider: 云服务商 <br/> type: 类型</td>
<td>节点组大小</td>
</tr>
</tbody>
</table>
<h3 id="虚拟容量指标">虚拟容量指标</h3>
<table>
<thead>
<tr>
<th>指标名称</th>
<th>标签</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>ruyi_virtual_capacity_run_count</td>
<td></td>
<td>虚拟容量运行次数</td>
</tr>
<tr>
<td>ruyi_node_request_sum</td>
<td>node: 节点名称<br/> id: 节点组ID <br/> nodegroup: 节点组名称<br/> resource: 资源类型</td>
<td>节点请求量</td>
</tr>
<tr>
<td>ruyi_node_allocatable</td>
<td>node: 节点名称<br/> id: 节点组ID <br/> nodegroup: 节点组名称<br/> resource: 资源类型</td>
<td>节点虚拟容量Allocatable</td>
</tr>
<tr>
<td>ruyi_virtual_capacity_ratio</td>
<td>node: 节点名称<br/> id: 节点组ID <br/> nodegroup: 节点组名称<br/>  type：类型</td>
<td>虚拟容量率</td>
</tr>
</tbody>
</table>
<p>另外，用户也可以通过Kubernetes的指标<code>kube_node_status_allocatable</code>查看实际虚拟容量的变化情况。</p>

</div>



    
      
  
  
  
  

  
  

  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-583a7f09d0feaa261a5b4bd84a75d62a">6 - 常见问题</h1>
    <div class="lead">使用Ruyi：云原生集群扩缩容引擎的常见问题及排查流程。</div>
	

<div class="pageinfo pageinfo-primary">
<p>使用Ruyi：云原生集群扩缩容引擎的常见问题及排查流程。</p>

</div>

<p>正在更新中，请稍后。</p>
<!-- ## 问题1：

## 问题2：

## 问题3： -->
</div>



    
      
  
  
  
  

  
  

  

    
	
  



          </main>
        </div>
      </div>
      
<footer class="bg-dark py-5 row d-print-none">
  <div class="container-fluid mx-sm-5">
    <div class="row">
      <div class="col-6 col-sm-4 text-xs-center order-sm-2">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="帮助和支持" aria-label="帮助和支持">
    <a class="text-white" target="_blank" rel="noopener" href="mailto:help@wiseinf.com?subject=%e5%b8%ae%e5%8a%a9%e5%92%8c%e6%94%af%e6%8c%81" aria-label="帮助和支持">
      <i class="fa fa-envelope"></i>
    </a>
  </li>
  
</ul>

        
        
      </div>
      <div class="col-6 col-sm-4 text-right text-xs-center order-sm-3">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="商务合作" aria-label="商务合作">
    <a class="text-white" target="_blank" rel="noopener" href="mailto:business@wiseinf.com?subject=%e5%95%86%e5%8a%a1%e5%90%88%e4%bd%9c" aria-label="商务合作">
      <i class="fa fa-envelope"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="网站源码" aria-label="网站源码">
    <a class="text-white" target="_blank" rel="noopener" href="https://github.com/wiseinf/wiseinf.github.io" aria-label="网站源码">
      <i class="fab fa-github"></i>
    </a>
  </li>
  
</ul>

        
        
      </div>
      <div class="col-12 col-sm-4 text-center py-2 order-sm-2">
        <small class="text-white">&copy; 2024 北京云智优本科技有限公司 保留所有权利</small>
        
        <p><small class="ms-1"><a href="https://beian.miit.gov.cn/" target="_blank" rel="noopener">京ICP备2023011485号</a></small>
        <small class="ms-1"><a href="https://www.beian.gov.cn/portal/registerSystemInfo?recordcode=11010802042031" target="_blank" rel="noopener">京公安网备11010802042031号</a></small></p>
	
		<p class="mt-2"><a href="/about/">关于我们</a></p>
	
      </div>
    </div>
  </div>
</footer>

    </div>
    
<script src="/local/cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
<script src="/local/stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>











<script src="/js/main.min.604e1b596f799449dffc6f056b597a5d8c1bfedb73f2844175ff85802887b69d.js" integrity="sha256-YE4bWW95lEnf/G8Fa1l6XYwb/ttz8oRBdf&#43;FgCiHtp0=" crossorigin="anonymous"></script>




  </body>
</html>
