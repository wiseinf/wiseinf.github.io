<!doctype html>
<html itemscope itemtype="http://schema.org/WebPage" lang="en" class="no-js">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="generator" content="Hugo 0.121.2">
<link rel="canonical" type="text/html" href="/docs/ruyi/configuration/">
<link rel="alternate" type="application/rss&#43;xml" href="/docs/ruyi/configuration/index.xml">
<meta name="robots" content="noindex, nofollow">


<link rel="shortcut icon" href="/favicons/favicon.ico" >
<link rel="apple-touch-icon" href="/favicons/apple-touch-icon-180x180.png" sizes="180x180">
<link rel="icon" type="image/png" href="/favicons/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="/favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/favicons/android-36x36.png" sizes="36x36">
<link rel="icon" type="image/png" href="/favicons/android-48x48.png" sizes="48x48">
<link rel="icon" type="image/png" href="/favicons/android-72x72.png" sizes="72x72">
<link rel="icon" type="image/png" href="/favicons/android-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/favicons/android-144x144.png" sizes="144x144">
<link rel="icon" type="image/png" href="/favicons/android-192x192.png" sizes="192x192">

<title>Configuration | Wiseinf</title>
<meta name="description" content="Description of the configuration of Ruyi: the cloud-native cluster scaling and expansion engine.
">
<meta property="og:title" content="Configuration" />
<meta property="og:description" content="Description of the configuration of Ruyi: the cloud-native cluster scaling and expansion engine.
" />
<meta property="og:type" content="website" />
<meta property="og:url" content="/docs/ruyi/configuration/" /><meta property="og:site_name" content="Wiseinf" />

<meta itemprop="name" content="Configuration">
<meta itemprop="description" content="Description of the configuration of Ruyi: the cloud-native cluster scaling and expansion engine.
"><meta name="twitter:card" content="summary"/><meta name="twitter:title" content="Configuration"/>
<meta name="twitter:description" content="Description of the configuration of Ruyi: the cloud-native cluster scaling and expansion engine.
"/>




<link rel="preload" href="/scss/main.min.b9f908f9939278827beae3d5d8ede093dde52fd2c4bcdf7ba620a3d524d46875.css" as="style">
<link href="/scss/main.min.b9f908f9939278827beae3d5d8ede093dde52fd2c4bcdf7ba620a3d524d46875.css" rel="stylesheet" integrity="">

<script
  src="https://code.jquery.com/jquery-3.6.0.min.js"
  integrity="sha384-vtXRMe3mGCbOeY7l30aIg8H9p3GdeSe4IFlP6G8JMa7o7lXvnz3GFKzPxzJdPfGK"
  crossorigin="anonymous"></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-STB7S5D1BR"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-STB7S5D1BR');
}
</script>
  </head>
  <body class="td-section">
    <header>
      <nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar">
<a class="navbar-brand" href="/"><span class="navbar-brand__logo navbar-logo"><svg id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="90" height="60" viewBox="0 0 90 60" enable-background="new 0 0 90 60"><image id="image0" width="90" height="60" x="0" y="0" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFoAAAA8CAMAAADR2113AAAABGdBTUEAALGPC/xhBQAAACBjSFJN AAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAUVBMVEUAAAA/R8s/ScwAoeci u1UisEwisEwzzGYhsUshsUwisUsAf38hsUshsEsisEwAqlUhsEwhsEshsU0isUoisUwA/wA/SMwA ougisUyZ2er///8l8mu7AAAAFnRSTlMAmUyZD4XZBWzxfQKoqKMDgutMd6EBrgesWwAAAAFiS0dE GnVn5DIAAAAJcEhZcwAAEnQAABJ0Ad5mH3gAAAAHdElNRQfmCwIILDYpiAQqAAAAuElEQVRYw+3V yQ7CMAxFUQMZmpZOKQXz/z8KRYLSxrCAFwkJ322ks4jimGhqc5TaTke7kxTNGet4yllDQp/Tvgh8 L5QVkt7zczWO9kuZuWlRdMHrOhBtQkL3HkNbTrMY2gm0w9AsBaGjSMf/pTPedc4XkvFdZ5xGKhN6 QH1PVb2SDyOKJmqWMhGObrt+vudhRNLXdfDYjZ4IS9/mMkZ60bf0m5T+efospbTSSiuttNJKK620 0kpnoC8F20SzlPhKcAAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAyMi0xMS0wMlQwODo0NDo1NCswMDow MEh3G+0AAAAldEVYdGRhdGU6bW9kaWZ5ADIwMjItMTEtMDJUMDg6NDQ6NTQrMDA6MDA5KqNRAAAA KHRFWHRkYXRlOnRpbWVzdGFtcAAyMDIyLTExLTAyVDA4OjQ0OjU0KzAwOjAwbj+CjgAAAABJRU5E rkJggg=="/></svg></span><span class="navbar-brand__name">Wiseinf</span></a>
<div class="td-navbar-nav-scroll ml-md-auto" id="main_navbar">
  <ul class="navbar-nav mt-2 mt-lg-0">
    <li class="nav-item dropdown mr-4 d-none d-lg-block">
      <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown"
      aria-haspopup="true" aria-expanded="false"><span>Product</span></a>
      <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
        <a class="dropdown-item" href="/products/cluster-optimizer"> Cluster Optimizer: Cloud Native Optimization Platform </a>
        <a class="dropdown-item" href="/products/wisecost"> Wisecost: Cloud Native Cost Management Platform </a>
        <a class="dropdown-item" href="/products/ruyi"> Ruyi: Cloud Native Cluster Autoscaling Engine</a>
      </div>
      </li>
      
      <li class="nav-item mr-4 mb-2 mb-lg-0">
      <a class="nav-link active" href="/docs/"><span class="active">Documentation</span></a>
      </li>
      
      <li class="nav-item mr-4 mb-2 mb-lg-0">
      <a class="nav-link" href="/pricing/"><span>Price</span></a>
      </li>
      
      <li class="nav-item mr-4 mb-2 mb-lg-0">
      <a class="nav-link" href="/services/"><span>Service</span></a>
      </li>
      <li class="nav-item dropdown mr-4 d-none d-lg-block">
      

<a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
	English
</a>
<div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
	
	<a class="dropdown-item" href="/zh-cn/docs/ruyi/configuration/">中文</a>
	
</div></li>
    </ul>
</div>
<div class="navbar-nav d-none d-lg-block">
  
</div>
</nav>
    </header>
    <div class="container-fluid td-outer">
      <div class="td-main">
        <div class="row flex-xl-nowrap">
          <main class="col-12 col-md-9 col-xl-8 pl-md-5" role="main">
            




<div class="td-content">
<div class="pageinfo pageinfo-primary d-print-none">
<p>
This is the multi-page printable view of this section.
<a href="#" onclick="print();return false;">Click here to print</a>.
</p><p>
<a href="/docs/ruyi/configuration/">Return to the regular view of this page</a>.
</p>
</div>



<h1 class="title">Configuration</h1>
<div class="lead">Description of the configuration of Ruyi: the cloud-native cluster scaling and expansion engine.</div>




    <ul>
    
  
  
  
  

  
    
    
	
<li>1: <a href="#pg-743cd90d3c1ba1709b66bd0042c39a58">Command Line Arguments</a></li>


    
    <ul>
        
  
  
  
  

  

    </ul>
    
  
    
    
	
<li>2: <a href="#pg-311560d092771780a32c6c35dc00ad8c"></a></li>


    
    <ul>
        
  
  
  
  

  

    </ul>
    
  

    </ul>


<div class="content">
      

<div class="pageinfo pageinfo-primary">
<p>Ruyi: Cloud-native cluster scaling and expansion engine.</p>

</div>

<h2 id="configuring-ruyi-cloud-native-cluster-scaling-and-expansion-engine">Configuring Ruyi: Cloud-native Cluster Scaling and Expansion Engine</h2>
<p>Ruyi: Cloud-native cluster scaling and expansion engine provides two main features: automatic scaling and virtual capacity. You can use either feature individually or use both features at the same time.</p>
<p>You can specify the features using the command line parameter <code>--features</code>.</p>
<p>The following describes the main configuration parameters for configuring the automatic scaling feature or the virtual capacity feature separately.</p>
<h3 id="configuring-the-automatic-scaling-feature">Configuring the Automatic Scaling Feature</h3>
<pre tabindex="0"><code>$ ruyi --features=Autoscaling --cloud-provider=alicloud --loglevel=debug --kubeconfig=/opt/ruyi/config/kubeconfig --config=/opt/ruyi/config/config.yaml
</code></pre><h3 id="configuring-the-virtual-capacity-feature">Configuring the Virtual Capacity Feature</h3>
<pre tabindex="0"><code>$ ruyi --features=VirtualCapacity --cloud-provider=alicloud --loglevel=debug --kubeconfig=/opt/ruyi/config/kubeconfig --config=/opt/ruyi/config/config.yaml --webhook-cert-dir=/opt/ruyi/certs/
</code></pre><p>The virtual capacity feature involves a virtual capacity controller and a webhook. You can control them separately using parameters.</p>
<p>For example, you can enable the virtual capacity controller alone by running the following command:</p>
<pre tabindex="0"><code>$ ruyi --features=VirtualCapacity --cloud-provider=alicloud --loglevel=debug --kubeconfig=/opt/ruyi/config/kubeconfig --config=/opt/ruyi/config/config.yaml --enable-virtual-capacity-controller=true  --enable-webhook=false
      
</code></pre><p>Or, you can start the webhook alone by running the following command:</p>
<pre tabindex="0"><code>$ ruyi --features=VirtualCapacity --cloud-provider=alicloud --loglevel=debug --kubeconfig=/opt/ruyi/config/kubeconfig --config=/opt/ruyi/config/config.yaml
--enable-virtual-capacity-controller=false  --enable-webhook=true --webhook-cert-dir=/opt/ruyi/certs/
</code></pre><p>When configuring the webhook, you must specify the <code>MutatingWebhookConfiguration</code>, as follows:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">apiVersion</span>: <span style="color:#ae81ff">admissionregistration.k8s.io/v1</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">kind</span>: <span style="color:#ae81ff">MutatingWebhookConfiguration</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">metadata</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">name</span>: <span style="color:#ae81ff">wiseinf-webhooks</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">webhooks</span>:
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">ruyi.wiseinf-system.svc</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">admissionReviewVersions</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">v1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">clientConfig</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">caBundle</span>: <span style="color:#ae81ff">&lt;CA Bundle&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">service</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">name</span>: <span style="color:#ae81ff">ruyi</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">namespace</span>: <span style="color:#ae81ff">wiseinf-system</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">path</span>: <span style="color:#ae81ff">/mutate--v1-node</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">rules</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#f92672">apiGroups</span>:
</span></span><span style="display:flex;"><span>          - <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">apiVersions</span>:
</span></span><span style="display:flex;"><span>          - <span style="color:#ae81ff">v1</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">operations</span>:
</span></span><span style="display:flex;"><span>          - <span style="color:#e6db74">&#34;UPDATE&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">resources</span>:
</span></span><span style="display:flex;"><span>          - <span style="color:#ae81ff">nodes/status</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">scope</span>: <span style="color:#e6db74">&#34;Cluster&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">failurePolicy</span>: <span style="color:#ae81ff">Ignore</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">sideEffects</span>: <span style="color:#ae81ff">None</span>
</span></span></code></pre></div><blockquote>
<p>Note: You must correctly specify the <code>caBundle</code> in the <code>MutatingWebhookConfiguration</code> to make the webhook work properly.</p>
</blockquote>
<h3 id="environment-variables">Environment Variables</h3>
<p>When using the automatic scaling feature, you need to provide cloud service provider-related information through environment variables.</p>
<p>If you are using Alibaba Cloud, you need to configure the AccessKey and its region through environment variables.</p>
<table>
<thead>
<tr>
<th>Environment Variable Name</th>
<th>Description</th>
<th>Default Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>ALIBABA_CLOUD_ACCESS_KEY_ID</td>
<td>Alibaba Cloud AccessKeyID</td>
<td>No default value</td>
</tr>
<tr>
<td>ALIBABA_CLOUD_ACCESS_KEY_SECRET</td>
<td>Alibaba Cloud AccessKeySecret</td>
<td>No default value</td>
</tr>
<tr>
<td>ALIBABA_CLOUD_REGION_ID</td>
<td>The ID of the region where the Alibaba Cloud cluster is located</td>
<td>cn-hangzhou</td>
</tr>
</tbody>
</table>
<p>If you are using AWS, you need to configure the AccessKey through environment variables.</p>
<table>
<thead>
<tr>
<th>Environment Variable Name</th>
<th>Description</th>
<th>Default Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>AWS_ACCESS_KEY_ID or AWS_ACCESS_KEY</td>
<td>AWS AccessKeyID</td>
<td>No default value</td>
</tr>
<tr>
<td>AWS_SECRET_ACCESS_KEY or AWS_SECRET_KEY</td>
<td>AWS AccessKeySecret</td>
<td>No default value</td>
</tr>
<tr>
<td>AWS_ASSUME_ROLE_ARN</td>
<td>AWS ASSUME_ROLE_ARN</td>
<td>No default value</td>
</tr>
</tbody>
</table>
<p>For more detailed configuration items, please refer to:</p>
<ul>
<li><a href="/docs/ruyi/configuration/command-line">Command Line Configuration</a></li>
<li><a href="/docs/ruyi/configuration/nodegroup">Node Group Configuration</a></li>
</ul>

</div>
</div>


  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-743cd90d3c1ba1709b66bd0042c39a58">1 - Command Line Arguments</h1>
    <div class="lead">Describes the command line arguments of Ruyi: Cloud Native Cluster Autoscaling Engine.</div>
	

<div class="pageinfo pageinfo-primary">
<p>Ruyi: Cloud Native Cluster Autoscaling Engine.</p>

</div>

<h2 id="command-line-arguments">Command Line Arguments</h2>
<p>You can get the usage of Ruyi engine by <code>--help</code>, as follows:</p>
<pre tabindex="0"><code>$ruyi --help
usage: ruyi --config=CONFIG [&lt;flags&gt;]

Flags:
      --help                     Show context-sensitive help (also try --help-long and --help-man).
  -f, --features=&#34;Autoscaling,VirtualCapacity&#34;  
                                 Enable ruyi features. Available options are Autoscaling, VirtualCapacity
      --cloud-provider=aws       Set cloud provider to use. Available options are (aws, alicloud)
      --config=CONFIG            Set config file location
      --kubeconfig=KUBECONFIG    Set kubeconfig file location
      --interval=60s             Set interval for evaluating node scale up or down
      --metrics-address=&#34;:8080&#34;  Set address for /metrics
      --health-probe-address=&#34;:8090&#34;  
                                 Set address for health probe
      --port=8443                Set port
      --dry-run                  Set dry-run argument. If true, forces dry run on all nodegroups
  -v, --loglevel=info            Set logging level. Available options are (trace, debug, info, warning, error, fatal, panic)
      --logfmt=text              Set logging format. Available options are (text, json)
      --enable-virtual-capacity-controller  
                                 Set enable virtual capacity controller
      --enable-webhook           Set enable webhook for virtual capacity
      --webhook-cert-dir=&#34;&#34;      Set webhook certificate directory
      --concurrency=5            Set concurrency
      --leader-elect             Enable leader election
      --leader-elect-lease-duration=15s  
                                 Set leader election lease duration
      --leader-elect-renew-deadline=10s  
                                 Set leader election renew deadline
      --leader-elect-retry-period=2s  
                                 Set leader election retry period
      --leader-elect-lease-namespace=&#34;wiseinf-system&#34;  
                                 Set leader election lease object namespace
      --leader-elect-lease-name=&#34;ruyi-lease&#34;  
                                 Set leader election lease object name
</code></pre><p>The following describes the parameters in detail.</p>
<h2 id="parameter-description">Parameter Description</h2>
<h3 id="--help"><code>--help</code></h3>
<p>The <code>--help</code> parameter provides the usage of the command line.</p>
<h3 id="-f---features"><code>-f, --features</code></h3>
<p>The <code>-f, --features</code> parameter indicates the features enabled by the engine. The <code>Autoscaling</code> option enables the autoscaling feature, and the <code>VirtualCapacity</code> option enables the virtual capacity feature.</p>
<p>The default value is <code>Autoscaling,VirtualCapacity</code>, which means both autoscaling and virtual capacity features are enabled by default.</p>
<h3 id="--cloud-provider"><code>--cloud-provider</code></h3>
<p>The <code>--cloud-provider</code> parameter indicates the cloud service provider used by the engine. Its value can be <code>aws</code> or <code>alicloud</code>, and the default value is <code>aws</code>.</p>
<h3 id="--config"><code>--config</code></h3>
<p>The <code>--config</code> parameter indicates the location of the node group configuration file used by the engine. For more information on the node group configuration, please see <a href="/docs/ruyi/configuration/nodegroup">Node Group Configuration</a>.</p>
<h3 id="--kubeconfig"><code>--kubeconfig</code></h3>
<p>The <code>--kubeconfig</code> parameter indicates the location of the kubeconfig file used by the engine. The default value is empty, in which case the cluster access configuration will be used.</p>
<h3 id="--interval"><code>--interval</code></h3>
<p>The <code>--interval</code> parameter indicates the scheduling interval used by the function features of the engine. For example, the autoscaling feature evaluates whether to expand or shrink the node pool at this time interval.</p>
<p>The default value is 60 seconds.</p>
<h3 id="--metrics-address"><code>--metrics-address</code></h3>
<p>The <code>--metrics-address</code> parameter indicates the port used by the monitoring metrics of the engine, from which you can obtain specific metric data at the <code>/metrics</code> endpoint.</p>
<h3 id="--health-probe-address"><code>--health-probe-address</code></h3>
<p>The <code>--health-probe-address</code> parameter indicates the monitoring probe address used by the engine, from which you can perform health probe and readiness probe at the <code>/healthz</code> and <code>/readyz</code> endpoints respectively.</p>
<h3 id="--port"><code>--port</code></h3>
<p>The <code>--port</code> parameter is the port used by the Webhook of the engine, and the default value is 8443.</p>
<h3 id="--dry-run"><code>--dry-run</code></h3>
<p>The <code>--dry-run</code> parameter indicates that the engine only runs without making any changes to the environment or nodes.</p>
<h3 id="-v---loglevelinfo"><code>-v, --loglevel=info</code></h3>
<p>The <code>--dry-run</code> parameter sets the log level. The available options are <code>trace</code>, <code>debug</code>, <code>info</code>, <code>warning</code>, <code>error</code>, <code>fatal</code>, <code>panic</code>, and the default value is <code>info</code>.</p>
<h3 id="--logfmt"><code>--logfmt</code></h3>
<p>The <code>--dry-run</code> parameter sets the output format of the log. The available options are <code>text</code>, <code>json</code>, and the default value is <code>text</code>, which means the output is in text format.</p>
<h3 id="--enable-virtual-capacity-controller"><code>--enable-virtual-capacity-controller</code></h3>
<p>The <code>--enable-virtual-capacity-controller</code> parameter indicates whether to enable the virtual capacity controller, and the default value is <code>true</code>.</p>
<h3 id="--enable-webhook"><code>--enable-webhook</code></h3>
<p>The <code>--enable-webhook</code> parameter indicates whether to enable Webhook, and the default value is <code>true</code>.</p>
<h3 id="--webhook-cert-dir"><code>--webhook-cert-dir</code></h3>
<p>The <code>--webhook-cert-dir</code> parameter indicates the directory location of the certificate when enabling Webhook. The engine will initialize the certificate of the Webhook through the files <code>tls.crt</code> and <code>tls.key</code> in this directory location.
If its value is empty, the Webhook will find the certificate in the directory <code>/tmp/k8s-webhook-server/serving-certs</code>.</p>
<h3 id="--concurrency"><code>--concurrency</code></h3>
<p>The <code>--concurrency</code> parameter indicates the number of concurrent processes. The default value is 5, but it is currently not used.</p>
<h3 id="--leader-elect"><code>--leader-elect</code></h3>
<p>The <code>--leader-elect</code> parameter sets whether to enable leader election. It is generally used in high availability environments.</p>
<h3 id="leader-elect-lease-duration"><code>leader-elect-lease-duration</code></h3>
<p>The <code>leader-elect-lease-duration</code> parameter sets the waiting time for non-master nodes to obtain the leader lease. The default value is 15 seconds.</p>
<h3 id="--leader-elect-renew-deadline"><code>--leader-elect-renew-deadline</code></h3>
<p>The <code>--leader-elect-renew-deadline</code> parameter sets the timeout for the master node to update the lease. The default value is 10 seconds.</p>
<h3 id="--leader-elect-retry-period"><code>--leader-elect-retry-period</code></h3>
<p>The <code>--leader-elect-retry-period</code> parameter sets the waiting time for nodes to retry when there is an error. The default value is 2 seconds.</p>
<h3 id="--leader-elect-lease-namespace"><code>--leader-elect-lease-namespace</code></h3>
<p>The <code>--leader-elect-lease-namespace</code> parameter sets the namespace where the lease is stored. The default value is <code>wiseinf-system</code>.</p>
<h3 id="--leader-elect-lease-name"><code>--leader-elect-lease-name</code></h3>
<p>The <code>--leader-elect-lease-name</code> parameter sets the name of the lease. The default value is <code>ruyi-lease</code>.</p>

</div>



    
      
  
  
  
  

  
  

  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-311560d092771780a32c6c35dc00ad8c">2 - </h1>
    
	<h2 id="节点组配置参数">节点组配置参数</h2>
<p>Ruyi：云原生集群扩缩容引擎的节点组配置参数。</p>
<h3 id="配置示例">配置示例</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">nodeGroups</span>:
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">name</span>: <span style="color:#e6db74">&#34;default-pool&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">nodeGroupId</span>: <span style="color:#e6db74">&#34;np1234567890&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">labels</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#f92672">key</span>: <span style="color:#ae81ff">spot_type</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">value</span>: <span style="color:#ae81ff">cpu</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">dryRun</span>: <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">enableAutoscaling</span>: <span style="color:#66d9ef">false</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">autoscaling</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">minNodes</span>: <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">maxNodes</span>: <span style="color:#ae81ff">100</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">enableScaleDown</span>: <span style="color:#66d9ef">false</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">scaleUp</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">threshold</span>: <span style="color:#ae81ff">0.70</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">scaleOnPodPending</span>: <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">silencePeriod</span>: <span style="color:#ae81ff">2m</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">scaleDown</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">threshold</span>: <span style="color:#ae81ff">0.40</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">softDeleteGracePeriod</span>: <span style="color:#ae81ff">1m</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">hardDeleteGracePeriod</span>: <span style="color:#ae81ff">10m</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">maxNodeRemovalRate</span>: <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">taintEffect</span>: <span style="color:#ae81ff">NoExecute</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">enableVirtualCapacity</span>: <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">virtualCapacity</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">prometheusAddress</span>: <span style="color:#e6db74">&#34;http://prometheus:9090&#34;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">prometheusWindow</span>: <span style="color:#e6db74">&#34;2m&#34;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">isThanos</span>: <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">thanosClusterKey</span>: <span style="color:#ae81ff">cluster</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">thanosClusterValue</span>: <span style="color:#ae81ff">default</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">reservationRatio</span>: <span style="color:#ae81ff">0.1</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">increaseSilencePeriod</span>: <span style="color:#ae81ff">2m</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">decreaseSilencePeriod</span>: <span style="color:#ae81ff">2m</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">stabilityWindow</span>: <span style="color:#ae81ff">5m</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">tolerance</span>: <span style="color:#ae81ff">0.1</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">cpuMaxUsage</span>: <span style="color:#ae81ff">0.7</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">maxValue</span>: <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">minValue</span>: <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">resourceReservation</span>: 
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">kubeReserved</span>: <span style="color:#ae81ff">200m</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">systemReserved</span>: <span style="color:#ae81ff">200m</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">reservedPercentage</span>: <span style="color:#ae81ff">0.1</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">alicloud</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">clusterId</span>: <span style="color:#ae81ff">c1234567890</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">lifecycle</span>: <span style="color:#ae81ff">spot</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">resourceTagging</span>: <span style="color:#66d9ef">false</span>
</span></span></code></pre></div><h3 id="配置参数说明">配置参数说明</h3>
<h4 id="name"><code>name</code></h4>
<p>节点组名称，用于输出日志等。不同的节点组名称必须唯一。</p>
<h4 id="labels和labelkey以及labelvalue"><code>labels</code>和<code>label.Key</code>以及<code>label.Value</code></h4>
<p>标签键值对数组，引擎通过此标签键值对数组来选择节点组。其中，<code>label.Key</code>和<code>label.Value</code>分别是键值对中的键和值。</p>
<h4 id="dryrun"><code>dryRun</code></h4>
<p>是否仅运行，不对实际环境做任何修改。该值为<code>false</code>时，可被子命令行参数的<code>dryRun</code>覆盖。</p>
<h4 id="nodegroupid"><code>nodeGroupId</code></h4>
<p>节点组ID，在云服务商的节点组ID，云服务商通过此参数来从对应云服务商获取改节点组信息。</p>
<h4 id="enableautoscaling"><code>enableAutoscaling</code></h4>
<p>指示是否启用自动扩缩容特性，默认为<code>true</code>。</p>
<h4 id="autoscaling"><code>autoscaling</code></h4>
<p>自动扩缩容配置，具体请参见<a href="#%E8%87%AA%E5%8A%A8%E6%89%A9%E7%BC%A9%E5%AE%B9%E9%85%8D%E7%BD%AE">自动扩缩容配置</a>。</p>
<h4 id="enablevirtualcapacity"><code>enableVirtualCapacity</code></h4>
<p>指示是否启用虚拟容量特性，默认为<code>true</code>。</p>
<h4 id="virtualcapacity"><code>virtualCapacity</code></h4>
<p>虚拟容量配置，具体请参见<a href="#%E8%99%9A%E6%8B%9F%E5%AE%B9%E9%87%8F%E9%85%8D%E7%BD%AE">虚拟容量配置</a>。</p>
<h4 id="alicloud"><code>alicloud</code></h4>
<p>阿里云服务商配置，具体请参见<a href="#%E9%98%BF%E9%87%8C%E4%BA%91%E6%9C%8D%E5%8A%A1%E5%95%86%E9%85%8D%E7%BD%AE">阿里云服务商配置</a>。</p>

</div>



    
      
  
  
  
  

  
  

  

    
	
  



          </main>
        </div>
      </div>
      
<footer class="bg-dark py-5 row d-print-none">
  <div class="container-fluid mx-sm-5">
    <div class="row">
      <div class="col-6 col-sm-4 text-xs-center order-sm-2">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="帮助和支持" aria-label="帮助和支持">
    <a class="text-white" target="_blank" rel="noopener" href="mailto:help@wiseinf.com?subject=%e5%b8%ae%e5%8a%a9%e5%92%8c%e6%94%af%e6%8c%81" aria-label="帮助和支持">
      <i class="fa fa-envelope"></i>
    </a>
  </li>
  
</ul>

        
        
      </div>
      <div class="col-6 col-sm-4 text-right text-xs-center order-sm-3">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="商务合作" aria-label="商务合作">
    <a class="text-white" target="_blank" rel="noopener" href="mailto:business@wiseinf.com?subject=%e5%95%86%e5%8a%a1%e5%90%88%e4%bd%9c" aria-label="商务合作">
      <i class="fa fa-envelope"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="网站源码" aria-label="网站源码">
    <a class="text-white" target="_blank" rel="noopener" href="https://github.com/wiseinf/wiseinf.github.io" aria-label="网站源码">
      <i class="fab fa-github"></i>
    </a>
  </li>
  
</ul>

        
        
      </div>
      <div class="col-12 col-sm-4 text-center py-2 order-sm-2">
        <small class="text-white">&copy; 2024 Wiseinf Inc. All Rights Reserved</small>
        
        
        
	
		<p class="mt-2"><a href="/about/">About Us</a></p>
	
      </div>
    </div>
  </div>
</footer>

    </div>
    
<script src="/local/cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
<script src="/local/stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>











<script src="/js/main.min.604e1b596f799449dffc6f056b597a5d8c1bfedb73f2844175ff85802887b69d.js" integrity="sha256-YE4bWW95lEnf/G8Fa1l6XYwb/ttz8oRBdf&#43;FgCiHtp0=" crossorigin="anonymous"></script>




  </body>
</html>
